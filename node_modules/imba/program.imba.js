var Me=Object.defineProperty;var cs=Object.getOwnPropertyDescriptor;var ps=Object.getOwnPropertyNames;var fs=Object.prototype.hasOwnProperty;var us=(n,e)=>{for(var t in e)Me(n,t,{get:e[t],enumerable:!0})},hs=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of ps(e))!fs.call(n,s)&&s!==t&&Me(n,s,{get:()=>e[s],enumerable:!(r=cs(e,s))||r.enumerable});return n};var ms=n=>hs(Me({},"__esModule",{value:!0}),n);var gn={};us(gn,{CompletionTypes:()=>V,Group:()=>B,ImbaDocument:()=>Ie,KeywordTypes:()=>g,Keywords:()=>me,M:()=>L,Monarch:()=>Ae,Node:()=>pe,Position:()=>J,Range:()=>H,Scope:()=>K,SemanticTokenModifiers:()=>Dr,SemanticTokenTypes:()=>ce,Sym:()=>G,SymbolFlags:()=>d,SymbolKind:()=>j,Token:()=>D,grammar:()=>ke,highlight:()=>ls,lexer:()=>ee});module.exports=ms(gn);var F=Symbol.for("#__init__"),mr=Symbol.for("#__initor__"),ds=Symbol.for("#__inited__"),hr=Symbol.for("#__hooks__");var ze=Symbol.for("imba");var bn={SUPERCALLS:1<<3,CONSTRUCTOR:1<<4},ye={IsExtension:1<<0,IsTag:1<<1,HasDescriptors:1<<2,HasSuperCalls:1<<3,HasConstructor:1<<4,HasFields:1<<5,HasMixins:1<<6,HasInitor:1<<7,HasDecorators:1<<8,IsObjectExtension:1<<9},se=new Map,gs=globalThis[ze]||(globalThis[ze]={counter:0,classes:se});function ue(n,e={}){return se.has(n)||se.set(n,{symbol:Symbol(),parent:Object.getPrototypeOf(n.prototype)?.constructor,for:n,uses:[],inits:[],id:gs.counter++,...e}),se.get(n)}function R(n,e){return typeof e=="string"?typeof n===e:e?.[Symbol.hasInstance]?.(n)}function I(n){return n?.toIterable?.()||n}function ys(n,e){if(!n||!e)return!1;if(n.get)return e.get===n.get;if(n.set)return e.set===n.set;if(n.value)return n.value===e.value}function dr(n,e,t){let r=n.constructor;t??(t=Object.getOwnPropertyDescriptors(e));let s=Object.getOwnPropertyDescriptors(n);delete t.constructor,t[F]&&delete t[F],Object.defineProperties(n,t);let i=ue(r);if(i&&i.augments)for(let a of i.augments){let o=Object.getOwnPropertyDescriptors(a.prototype),p={};for(let c of Object.keys(t)){let l=t[c];o[c]&&!ys(s[c],o[c])?console.warn("wont extend",c):p[c]=l}Object.keys(p).length&&dr(a.prototype,null,p)}return n}function gr(n,e){let t=ue(n),r=ue(e);if(r.parent&&!(n.prototype instanceof r.parent))throw new Error(`Mixin ${r.name} has superclass not present in target class`);if(!r.augments){r.augments=new Set;let i=r.ref=Symbol(),a=Object[Symbol.hasInstance];e.prototype[i]=!0,Object.defineProperty(e,Symbol.hasInstance,{value:function(o){return this===e?o&&!!o[i]:a.call(this,o)}})}if(n.prototype[r.ref])return n;for(let i of r.uses)gr(n,i,t);r.augments.add(n),t.uses.push(e);let s=Object.getOwnPropertyDescriptors(e.prototype);delete s.constructor,s[F]&&(t.inits.push(e.prototype[F]),delete s[F]),Object.defineProperties(n.prototype,s);try{t.top.version++}catch{}return n}var Q={cache:{},self:null,target:null,proxy:new Proxy({},{apply:(n,e,...t)=>Q.target[e].apply(Q.self,t),get:(n,e)=>Reflect.get(Q.target,e,Q.self),set:(n,e,t,r)=>Reflect.set(Q.target,e,t,Q.self)})};function $(n,e,t,r,s=null){let i=Object.getPrototypeOf(n.prototype);if(r&ye.HasMixins&&(se.set(n,se.get(i.constructor)),i=Object.getPrototypeOf(i)),s){let p=r&ye.IsObjectExtension?s:s.prototype,c=ue(n);if(c.uses?.length){s===p&&console.warn("Cannot extend object with mixins");for(let l of c.uses)gr(s,l)}return r&ye.HasSuperCalls&&(Q.cache[e]=Object.create(Object.getPrototypeOf(p),Object.getOwnPropertyDescriptors(p))),dr(p,n.prototype),s}let a=i?.constructor,o=ue(n,{symbol:e});return t&&n.name!==t&&Object.defineProperty(n,"name",{value:t,configurable:!0}),o.flags=r,r&ye.HasConstructor&&(n.prototype[mr]=e),a?.inherited instanceof Function&&a.inherited(n),n}function N(n,e){n[mr]===e&&(n[ds]?.(),n[hr]&&n[hr].inited(n))}var ne=Symbol.for("#source"),bs=Symbol.for("#lineText"),_s=Symbol.for("#version"),yr=new WeakMap,br=Symbol(),Be=class{[F](e=null,t=!0,r=!0){this.line=e?e.line:void 0,this.character=e?e.character:void 0,this.offset=e?e.offset:void 0}constructor(e,t,r,s=null){this[F](),this.line=e,this.character=t,this.offset=r,this[_s]=s,N(this,br)}toString(){return""+this.line+":"+this.character}valueOf(){return this.offset}},J=Be;(()=>{$(Be,br,"Position",16)})();var _r=Symbol(),Le=class{[F](e=null,t=!0,r=!0){this.start=e?e.start:void 0,this.end=e?e.end:void 0}constructor(e,t){this[F](),this.start=e,this.end=t,N(this,_r)}get offset(){return this.start.offset}get length(){return this.end.offset-this.start.offset}get 0(){return this.start.offset}get 1(){return this.end.offset}getText(e){return e.slice(this.start,this.end)}equals(e){return e.offset==this.offset&&e.length==this.length}},H=Le;(()=>{$(Le,_r,"Range",16)})();var xs={Error:1,Warning:2,Information:3,Hint:4,error:1,warning:2,warn:2,info:3,hint:4},xr=Symbol(),Pe=class{constructor(e,t=null){this.range=e.range,this.severity=xs[e.severity]||e.severity,this.code=e.code,this.source=e.source,this.message=e.message,yr.set(this,t),N(this,xr)}get[ne](){return yr.get(this)}get[bs](){return this[ne].doc.getLineText(this.range.start.line)}toSnippet(){let e=this.range.start,t=this.range.end,r=""+this[ne].sourcePath+":"+(e.line+1)+":"+(e.character+1)+": "+this.message,s=this[ne].doc.getLineText(e.line),i=[r,s];return i.push(s.replace(/[^\t]/g," ").slice(0,e.character)+"^".repeat(t.character-e.character)),i.join(`
`).replace(/\t/g,"    ")+`
`}toError(){let e=this.range.start,t=this.range.end,r=""+this[ne].sourcePath+":"+(e.line+1)+":"+(e.character+1)+": "+this.message,s=new SyntaxError(r),i=this[ne].doc.getLineText(e.line),a=[r,i];return a.push(i.replace(/[^\t]/g," ").slice(0,e.character)+"^".repeat(t.character-e.character)),s.stack=`
`+a.join(`
`).replace(/\t/g,"    ")+`
`,s}raise(){throw this.toError()}},kr=Pe;(()=>{$(Pe,xr,"Diagnostic",16)})();var wr=Symbol(),Re=class{constructor(e,t){this.cache={},this.rules=e,this.matcher=t,N(this,wr)}convert(e){for(let t=0,r=I(this.rules),s=r.length;t<s;t++){let i=r[t];if(this.matcher&&this.matcher(i[0],e))return e[1]}return 0}},$r=Re;(()=>{$(Re,wr,"Converter",16)})();function be(n,e,t=1e5){let r=n;for(;r&&t>0;){if(r.match(e))return r;t--,r=r.prev}return null}function Fe(n,e,t){t===void 0&&(t=0);for(var r=e?[t]:[],s=0;s<n.length;){var i=n.charCodeAt(s);(i===13||i===10)&&(i===13&&s+1<n.length&&n.charCodeAt(s+1)===10&&s++,r.push(t+s+1)),s++}return r}function vr(n){var e=n.start,t=n.end;return e.line>t.line||e.line===t.line&&e.character>t.character?new H(t,e):R(n,H)?n:new H(e,t)}function Sr(n){return n!=null&&typeof n.text=="string"&&n.range===void 0}function Tr(n){let e=n.split(/\n/),t=[],r={indent:-1,children:[]},s=r,i,a=Date.now();for(let o=0,p=I(e),c=p.length;o<c;o++){let l=p[o];if(l.match(/^\s*$/))continue;let f=l.match(/^\t*/)[0].length;for(;r.indent>=f;)r=r.parent||s;if(i=l.match(/^(\t*((?:export )?(?:static )?(?:extend )?)(class|tag|def|get|set|prop|attr) )(\@?[\w\-\$\:]+(?:\.[\w\-\$]+)?)/),i){let u=i[3],h=i[4],S=r.name?r.name+".":"",v=i[2].trim().split(/\s+/),E="",y={start:{line:o,character:i[1].length},end:{line:o,character:i[0].length}},m={kind:u,ownName:h,name:S+h,span:y,indent:f,modifiers:v,children:[],parent:r==s?null:r,type:u,data:{},static:v.indexOf("static")>=0,extends:v.indexOf("extend")>=0};m.static&&(m.containerName="static"),m.containerName=i[2]+i[3],u=="tag"&&(i=l.match(/\<\s+([\w\-\$\:]+(?:\.[\w\-\$]+)?)/))&&(m.superclass=i[1]),r.type=="tag"&&(E="```html\n<"+r.name+" "+h+">\n```\n",m.description={kind:"markdown",value:E}),r.children.push(m),r=m,t.push(m)}}return s.all=t,console.log("fast outline",n.length,Date.now()-a),s}var je=[/^/,{token:"@rematch",next:"@pop"}],Ir={token:"@rematch",next:"@pop"},Or={token:"white.indent",next:"@>illegal_indent"};function ks(n,e="#"){typeof n=="string"&&(n=n.split(" "));let t=n.slice().sort(function(r,s){return s.length-r.length});return t=t.map(function(r){let s=r.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&");return e.replace("#",s)}),new RegExp("(?:"+t.join("|")+")")}function A(n,e,t,r={}){var s;n==null?n=Or:n==1?n={next:"@>"}:n==2?n={next:"@>_indent&-_indent"}:typeof n=="string"&&(n={next:n}),e==-1&&(e=Ir),t==-1?t=Ir:t==0&&(r.comment??(r.comment=!0),t={}),n=Object.assign({token:"white.tabs"},n||{}),t=Object.assign({token:"white.tabs"},t||{}),e=Object.assign({token:"@rematch",next:"@pop"},e||{});let i={"$1==$S2	":n,"$1==$S2":{cases:{"$1==$S6":t,"@default":{token:"@rematch",switchTo:"@*$1"}}},"@default":e};s=0;for(let o of["next","switchTo"]){let p=s++;n[o]&&n[o].indexOf("*")==-1&&(n[o]+="*$1")}let a=[/^(\t*)(?=[^ \t\n])/,{cases:i}];if(r.comment){let o={};for(let p=0,c=Object.keys(i),l=c.length,f,u;p<l;p++){f=c[p],u=i[f];let h=Object.assign({},u);!h.next&&!h.switchTo&&(h.next="@>_comment"),o[f]=h}return[[/^(\t*)(?=#\s|#$)/,{cases:o}],a]}return a}var Ne={root:[[/^@comment/,"comment","@>_comment"],[/^(\t+)(?=[^\t\n])/,{cases:{"$1==$S2	":{token:"white.indent",next:"@>_indent*$1"},"@default":"white.indent"}}],"block_"],_comment:[[/^([\t\s\n]*)$/,"comment"],[/^(\t*)([\S\s]*)/,{cases:{"$1~$S2	*":{token:"comment"},"@default":{token:"@rematch",next:"@pop"}}}],[/[\S\s]+/,"comment"]],illegal_indent:[A()],identifier_:[[/\$\w+\$/,"identifier.env"],[/\$\d+/,"identifier.special"],[/\#+@id/,"identifier.symbol"],[/\Â¶@id/,"ivar"],[/@id\!?/,{cases:{this:"this",self:"self","@keywords":"keyword.$#","$0~[A-Z].*":"identifier.uppercase.$F","@default":"identifier.$F"}}]],block_:[[/^(\t+)(?=[\r\n]|$)/,"white.tabs"],"class_","tagclass_","var_","func_","import_","export_","flow_","for_","try_","catch_","while_","css_","tag_","do_","block_comment_","expr_",[/[ ]+/,"white"],"common_"],indentable_:[[/^[ ]+/,"white"],A("@>_paren_indent&-_indent",null,null),[/^(\t+)(?=[\r\n]|$)/,"white.tabs"],"whitespace"],_indent:[A(2,-1,0),"block_"],_paren_indent:[A(2,-1,0),"block_",[/\)|\}|\]/,"@rematch","@pop"]],block:[A("@>",-1,0),"block_"],bool_:[[/(true|false|yes|no|undefined|null)(?![\:\-\w\.\_])/,"boolean"]],op_:[[/\s+\:\s+/,"operator.ternary"],[/(@unspaced_ops)/,{cases:{"@spread":"operator.spread","@access":"operator.access","@default":"operator"}}],[/\/(?!\/)/,"operator.math"],[/\&(?=[,\)])/,"operator.special.blockparam"],[/(\s*)(@symbols)(\s*)/,{cases:{"$2@assignments":"operator.assign","$2@math":"operator.math","$2@operators":"operator","$2@logic":"operator.logic","$2@access":"operator.access","@default":"delimiter"}}],[/\&\b/,"operator"]],keyword_:[[/new@B/,"keyword.new"],[/isa@B/,"keyword.isa"],[/is@B/,"keyword.is"],[/(switch|when|throw|continue|break|then|await|typeof|by)@B/,"keyword.$1"],[/delete@B/,"keyword.delete"],[/and@B|or@B/,"operator.flow"]],return_:[[/return@B/,"keyword.new"]],primitive_:["string_","number_","regexp_","bool_"],value_:["primitive_","keyword_","implicit_call_","parens_","key_","access_","identifier_","array_","object_"],expr_:["comment_","inline_var_","return_","value_","tag_","op_","type_","spread_"],attr_expr_:["primitive_","parens_","access_","identifier_","array_","object_","tag_","op_"],access_:[[/(\.\.?)(@propid\!?)/,{cases:{"$2~[A-Z].*":["operator.access","accessor.uppercase"],"$2~#.*":["operator.access","accessor.symbol"],"@default":["operator.access","accessor"]}}]],call_:[[/\(/,"(","@call_body"]],key_:[[/(\#+@id)(\:\s*)/,["key.symbol","operator.assign.key-value"]],[/(@propid)(\:\s*)/,{cases:{"@default":["key","operator.assign.key-value"]}}]],implicit_call_:[[/(\.\.?)(@propid)@implicitCall/,{cases:{"$2~[A-Z].*":["operator.access","accessor.uppercase","@implicit_call_body"],"@default":["operator.access","accessor","@implicit_call_body"]}}],[/(@propid)@implicitCall/,{cases:{"$2~[A-Z].*":["identifier.uppercase","@implicit_call_body"],"@default":["identifier","@implicit_call_body"]}}]],implicit_call_body:[je,[/\)|\}|\]|\>/,"@rematch","@pop"],"arglist_","whitespace"],arglist_:["do_","expr_",[/\s*\,\s*/,"delimiter.comma"]],params_:[[/\[/,"array.[","@array_var_body=decl-param"],[/\{/,"object.{","@object_body=decl-param"],[/(@variable)/,"identifier.decl-param"],"spread_","type_",[/\s*\=\s*/,"operator","@var_value="],[/\s*\,\s*/,"separator"]],object_:[[/\{/,"object.{","@object_body"]],parens_:[[/\(/,"parens.(","@parens_body"]],parens_body:[[/\)/,")","@pop"],"indentable_","arglist_"],array_:[[/\[/,"array.[","@array_body"]],array_body:[[/\]@implicitCall/,{token:"]",switchTo:"@implicit_call_body="}],[/\]/,"]","@pop"],[/\)|\}/,"invalid"],"indentable_","expr_",[",","delimiter"]],object_body:[[/\}/,"}","@pop"],[/(@id)(\s*:\s*)/,["key","operator.assign.key-value","@object_value"]],[/(@id)/,"identifier.$F"],[/\[/,"[","@object_dynamic_key="],[/\s*=\s*/,"operator.assign","@object_value="],[/:/,"operator.assign.key-value","@object_value="],[/\,/,"delimiter.comma"],"indentable_","expr_"],object_value:[je,[/,|\}|\]|\)/,"@rematch","@pop"],"expr_"],object_dynamic_key:[["]","]","@pop"],"expr_"],comment_:[[/#(\s.*)?(\n|$)/,"comment"]],block_comment_:[[/###/,"comment.start","@_block_comment"]],_block_comment:[[/###/,"comment.end","@pop"],[/[^#]+/,"comment"],[/#(?!##)/,"comment"]],try_:[[/try@B/,"keyword.try","@>_try&try"]],catch_:[[/(catch\s+)(?=@id(\s|$))/,"keyword.catch","@catch_start&catch"],[/catch@B/,"keyword.catch","@catch_start&catch"]],catch_start:[[/@id/,"identifier.decl-const",{switchTo:"@>_catch"}],[/.?/,"@rematch",{switchTo:"@>_catch"}]],_catch:[A("@>block",-1,0),"block_"],_try:[A("@>block",-1,0),"block_"],do_:[[/do(?=\()/,"keyword.do","@>do_start&do"],[/do(?=\s*\|)/,"keyword.do","@>do_piped&do"],[/do@B/,"keyword.do","@>_do&do"]],do_start:[A(null,-1,-1),[/\(/,"(",{switchTo:"@_do_params"}],[/./,"@rematch",{switchTo:"@_do"}]],do_piped:[A(null,-1,-1),[/\s*\|/,"args.open",{switchTo:"@_do_piped_params"}],[/./,"@rematch",{switchTo:"@_do"}]],_do_piped_params:[[/\|/,"args.close",{switchTo:"@_do"}],"params_"],_do_params:[[/\)/,")",{switchTo:"@_do"}],"params_"],_do:[A(2,-1,0),[/(\}|\)|\])/,"@rematch","@pop"],"block_"],class_:[[/(extend)(?=\s+class )/,"keyword.$1"],[/(global)(?=\s+class )/,"keyword.$1"],[/(class)(\s)(@id)/,["keyword.$1","white.$1name","entity.name.class.decl-const","@class_start="]],[/(class)(?=\n)/,"keyword.$1","@>_class&class="]],class_start:[[/(\s+\<\s+)(@id)/,["keyword.extends","identifier.superclass"]],[/@comment/,"comment"],[/^/,"@rematch",{switchTo:"@>_class&class="}]],tagclass_:[[/(extend)(?=\s+tag )/,"keyword.$1"],[/(global)(?=\s+tag )/,"keyword.$1"],[/(tag)(\s)(@constant)/,["keyword.tag","white.tagname","entity.name.component.local","@tagclass_start="]],[/(tag)(\s)(@id)/,["keyword.tag","white.tagname","entity.name.component.global","@tagclass_start="]]],tagclass_start:[[/(\s+\<\s+)(@id)/,["keyword.extends","identifier.superclass"]],[/@comment/,"comment"],[/^/,"@rematch",{switchTo:"@>_tagclass&component="}]],import_:[[/(import)(?=\s+['"])/,"keyword.import","@>import_source"],[/(import)(\s+type)(?=\s[\w\$\@\{])/,["keyword.import","keyword.type","@>import_body&-_imports=decl-import/part"]],[/(import)@B/,"keyword.import","@>import_body&-_imports=decl-import/part"]],import_body:[A(null,-1,0),[/(@esmIdentifier)( +from)/,["identifier.$F.default","keyword.from",{switchTo:"@import_source"}]],[/(\*)(\s+as\s+)(@esmIdentifier)(\s+from)/,["keyword.star","keyword.as","identifier.$F.ns","keyword.from",{switchTo:"@import_source"}]],[/(@esmIdentifier)(\s*,\s*)(\*)(\s+as\s+)(@esmIdentifier)(from)/,["identifier.$F.default","delimiter.comma","keyword.star","keyword.as","identifier.$F.ns","keyword.from",{switchTo:"@import_source"}]],[/\ *from/,"keyword.from",{switchTo:"@import_source"}],[/\{/,"specifiers.{","@esm_specifiers/part"],[/(@esmIdentifier)/,"identifier.$F",{switchTo:"@/delim"}],[/\s*\,\s*/,"delimiter.comma",{switchTo:"@/part"}],"comma_","common_"],import_source:[A(null,-1,0),[/["']/,"path.open","@_path=$#"],je],export_:[[/(export)( +)(default)@B/,["keyword.export","white","keyword.default"]],[/(export)(?= +(let|const|var|class|tag)@B)/,"keyword.export"],[/(export)( +)(global)@B/,["keyword.export","white","keyword.global"]],[/(export)(\s+\*\s+)(from)@B/,["keyword.export","operator.star","keyword.from","@>import_source"]],[/(export)@B/,"keyword.export","@>export_body"]],export_body:[A(null,-1,0),[/(\*)(\s+as\s+)(@esmIdentifier)/,["keyword.star","keyword.as","identifier.const.export"]],[/(@esmIdentifier)(\s+as\s+)(default)/,["alias","keyword.as","alias.default"]],[/(@esmIdentifier)(\s+as\s+)(@esmIdentifier)/,["alias","keyword.as","identifier.const.export"]],[/from/,"keyword.from",{switchTo:"@import_source"}],[/\{/,"{","@esm_specifiers=export/part"],[/(@esmIdentifier)/,"identifier.const.export"],[/\*/,"operator.star"],"comma_","common_"],esm_specifiers:[[/\}/,"}","@pop"],[/(@esmIdentifier)(\s+as\s+)(@esmIdentifier)/,["alias","keyword.as","identifier.const.$F",{switchTo:"@/delim"}]],[/@esmIdentifier/,{cases:{"$/==part":{token:"identifier.const.$S4",switchTo:"@/delim"},"@default":{token:"invalid"}}}],[/\s*\,\s*/,"delimiter.comma",{switchTo:"@/part"}],"whitespace"],_path:[[/[^"'\`\{\\]+/,"path"],[/@escapes/,"path.escape"],[/\./,"path.escape.invalid"],[/\{/,"invalid"],[/["'`]/,{cases:{"$#==$F":{token:"path.close",next:"@pop"},"@default":"path"}}]],member_:[[/(constructor)@B/,"entity.name.constructor","@>def_params&def/def"],[/(def|get|set)(\s)(@defid)/,["keyword.$1","white.entity","entity.name.$1","@>def_params&$1/$1"]],[/(def|get|set)(\s)(\[)/,["keyword.$1","white.entity","$$","@>def_dynamic_name/$1"]]],func_:[[/export(?=\s+(get|set|def|global) )/,"keyword.export"],[/global(?=\s+(get|set|def) )/,"keyword.global"],[/(def)(\s)(@id)(\.)(@defid)/,["keyword.$1","white.entity","identifier.target","operator","entity.name.def","@>def_params&$1/$1"]],[/(def)(\s)(@defid)/,["keyword.$1","white.entity","entity.name.function.decl-const-func","@>def_params&$1/$1"]]],flow_:[[/(if|else|elif|unless)(?=\s|$)/,["keyword.$1","@flow_start=$1"]]],flow_start:[A({switchTo:"@>_flow&$F"},-1,-1),[/[ \t]+/,"white"],"expr_"],for_:[[/for(?: own)?@B/,"keyword.$#","@for_start&forscope=decl-for"]],while_:[[/(while|until)@B/,"keyword.$#","@>while_body"]],while_body:[A(2,-1,0),"block_"],for_start:[A({switchTo:"@>for_body"},-1,-1),[/\[/,"array.[","@array_var_body"],[/\{/,"object.{","@object_body"],[/(@variable)/,"identifier.$F"],[/(\s*\,\s*)/,"separator","@=decl-for-index"],[/\s(in|of)@B/,"keyword.$1",{switchTo:"@>for_source="}],[/[ \t]+/,"white"],"type_"],for_source:[A({switchTo:"@>for_body"},-1,{switchTo:"@for_body"}),"expr_",[/[ \t]+/,"white"]],for_body:[A(2,-1,0),"block_"],decorator_:[[/(@decid)(\()/,["decorator","$2","@_decorator_params"]],[/(@decid)/,"decorator"]],_decorator_params:[[/\)/,")","@pop"],"params_"],field_:[[/((?:lazy )?)((?:static )?)(const|let|attr)(?=\s|$)/,["keyword.lazy","keyword.static","keyword.$1","@_vardecl=field-$3"]],[/(static\s+)(?=@fieldid)/,"keyword.static"],[/(@fieldid)(?=$)/,"entity.name.field"],[/(@fieldid)/,["entity.name.field","@_field_1"]]],_field_1:[A(null,-1,-1),"type_",[/(\s*=)(?!\=)/,["operator.assign","@>_field_value&field"]],[/(\s*(?:\@)set\s*)/,["keyword.spy","@>_def&spy"]]],_field_value:[A(2,-1,0),"block_",[/(\s*(?:\@)set\s*)/,["@rematch","@pop"]]],var_:[[/((?:export )?)(const|let)(?=\s[\[\{\$a-zA-Z]|\s*$)/,["keyword.export","keyword.$1","@_vardecl=decl-$2"]],[/((?:export )?)(const|let)(?=\s|$)/,["keyword.export","keyword.$1"]]],inline_var_:[[/(const|let)(?=\s[\[\{\$a-zA-Z]|\s*$)/,["keyword.$1","@inline_var_body=decl-$1"]]],string_:[[/"""/,"string",'@_herestring="""'],[/'''/,"string","@_herestring='''"],[/["'`]/,"string.open","@_string=$#"]],number_:[[/0[xX][0-9a-fA-F_]+/,"number.hex"],[/0[b][01_]+/,"number.binary"],[/0[o][0-9_]+/,"number.octal"],[/(\d+)([a-z]+|\%)/,["number","unit"]],[/(\d*\.\d+(?:[eE][\-+]?\d+)?)([a-z]+|\%)/,["number.float","unit"]],[/\d+[eE]([\-+]?\d+)?/,"number.float"],[/\d[\d_]*\.\d[\d_]*([eE][\-+]?\d+)?/,"number.float"],[/\d[\d_]*/,"number.integer"],[/0[0-7]+(?!\d)/,"number.octal"],[/\d+/,"number"]],_string:[[/[^"'\`\{\\]+/,"string"],[/@escapes/,"string.escape"],[/\./,"string.escape.invalid"],[/\{/,{cases:{"$F=='":"string","@default":{token:"string.bracket.open",next:"@interpolation_body"}}}],[/["'`]/,{cases:{"$#==$F":{token:"string.close",next:"@pop"},"@default":"string"}}],[/#/,"string"]],_herestring:[[/("""|''')/,{cases:{"$1==$F":{token:"string",next:"@pop"},"@default":"string"}}],[/[^#\\'"\{]+/,"string"],[/['"]+/,"string"],[/@escapes/,"string.escape"],[/\./,"string.escape.invalid"],[/\{/,{cases:{'$F=="""':{token:"string",next:"@interpolation_body"},"@default":"string"}}],[/#/,"string"]],interpolation_body:[[/\}/,"string.bracket.close","@pop"],"expr_"],_class:[A(Or,-1,0),"css_","member_","comment_","decorator_",[/(get|set|def|static|prop|attr)@B/,"keyword.$0"],"field_","common_"],_tagclass:["_class",[/(?=\<self)/,"entity.name.def.render","@_render&def"]],def_params:[[/\(/,"(","@def_parens"],[/^/,"@rematch",{switchTo:"@_def"}],[/do@B/,"keyword.do",{switchTo:"@_def"}],"params_",[/@comment/,"comment"]],def_parens:[[/\)/,")","@pop"],"params_"],def_dynamic_name:[["]",{token:"square.close",switchTo:"@def_params&$/"}],"expr_"],_render:[A(2,-1,-1),"block_"],_def:[A(2,-1,0),"block_"],_flow:[A(2,-1,0),"block_"],_varblock:[A(1,-1,-1),[/\[/,"array.[","@array_var_body"],[/\{/,"object.{","@object_body"],[/(@variable)/,"identifier.$F"],[/\s*\,\s*/,"separator"],[/(\s*\=\s*)(?=(for|while|until|if|unless|try)\s)/,"operator","@pop"],[/(\s*\=\s*)/,"operator","@var_value="],"type_",[/#(\s.*)?\n?$/,"comment"]],_vardecl:[A(null,-1,-1),[/\[/,"array.[","@array_var_body"],[/\{/,"object.{","@object_body"],[/(@variable)(?=\n|,|$)/,"identifier.$F","@pop"],[/(@variable)/,"identifier.$F"],[/(\s*\=\s*)/,"operator.declval",{switchTo:"@var_value&value="}],"type_"],array_var_body:[[/\]/,"]","@pop"],[/\{/,"object.{","@object_body"],[/\[/,"array.[","@array_var_body"],"spread_",[/(@variable)/,"identifier.$F"],[/(\s*\=\s*)/,"operator.assign","@array_var_body_value="],[",","delimiter"]],array_var_body_value:[[/(?=,|\)|]|})/,"delimiter","@pop"],"expr_"],inline_var_body:[[/\[/,"array.[","@array_var_body"],[/\{/,"object.{","@object_body"],[/(@variable)/,"identifier.$F"],[/(\s*\=\s*)/,"operator","@pop"],"type_"],var_value:[[/(?=,|\)|]|})/,"delimiter","@pop"],A({switchTo:"@>block"},-1,-1),"block_"],common_:[[/^(\t+)(?=\n|$)/,"white.tabs"],"whitespace"],comma_:[[/\s*,\s*/,"delimiter.comma"]],spread_:[[/\.\.\./,"operator.spread"]],type_:[[/\\/,"@rematch","@_type&-_type/0"]],_type:[A(-1,-1,-1),[/\\/,"delimiter.type.prefix"],[/\[/,"delimiter.type","@/]"],[/\(/,"delimiter.type","@/)"],[/\{/,"delimiter.type","@/}"],[/\</,"delimiter.type","@/>"],[/\|/,"delimiter.type.union"],[/\,|\s|\=|\./,{cases:{"$/==0":{token:"@rematch",next:"@pop"},"@default":"type"}}],[/[\]\}\)\>]/,{cases:{"$#==$/":{token:"delimiter.type",next:"@pop"},"@default":{token:"@rematch",next:"@pop"}}}],[/[\w\-\$]+/,"type"]],css_:[[/global(?=\s+css@B)/,"keyword.$#"],[/css(?:\s+)?/,"keyword.css","@>css_selector&rule-_sel"]],sel_:[[/(\%)((?:@id)?)/,["style.selector.mixin.prefix","style.selector.mixin"]],[/(\@)(\.{0,2}[\w\-\<\>\!]*\+?)/,"style.selector.modifier"],[/(\@)(\.{0,2}[\w\-\<\>\!]*)/,"style.selector.modifier"],[/\.([\w\-]+)/,"style.selector.class-name"],[/\#([\w\-]+)/,"style.selector.id"],[/([\w\-]+)/,"style.selector.element"],[/(>+|~|\+)/,"style.selector.operator"],[/(\*+)/,"style.selector.element.any"],[/(\$)((?:@id)?)/,["style.selector.reference.prefix","style.selector.reference"]],[/\&/,"style.selector.context"],[/\(/,"delimiter.selector.parens.open","@css_selector_parens"],[/\[/,"delimiter.selector.attr.open","@css_selector_attr"],[/\s+/,"white"],[/,/,"style.selector.delimiter"],[/#(\s.*)?\n?$/,"comment"]],css_props:[A(null,-1,0),[/(?=@cssPropertyKey)/,"","@css_property&-_styleprop-_stylepropkey"],[/#(\s.*)?\n?$/,"comment"],[/(?=[\%\*\w\&\$\>\.\[\@\!]|\#[\w\-])/,"","@>css_selector&rule-_sel"],[/\s+/,"white"]],css_selector:[A({switchTo:"@css_props"},-1,{token:"@rematch",switchTo:"@css_props&_props"}),[/(\}|\)|\])/,"@rematch","@pop"],[/(?=\s*@cssPropertyKey)/,"",{switchTo:"@css_props&_props"}],[/\s*#\s/,"@rematch",{switchTo:"@css_props&_props"}],"sel_"],css_inline:[[/\]/,"style.close","@pop"],[/(?=@cssPropertyKey)/,"","@css_property&-_styleprop-_stylepropkey"],[/(?=@cssPropertyPath\])/,"","@css_property&-_styleprop-_stylepropkey"]],css_selector_parens:[[/\)/,"delimiter.selector.parens.close","@pop"],"sel_"],css_selector_attr:[[/\]/,"delimiter.selector.parens.close","@pop"],"sel_"],css_property:[A(null,-1,-1),[/\]/,"@rematch","@pop"],[/(\d+)(@id)/,["style.property.unit.number","style.property.unit.name"]],[/((--|\$)@id)/,"style.property.var"],[/(-*@id)/,"style.property.name"],[/@cssModifier/,"style.property.modifier"],[/(\@+|\.+)(@id\-?)/,["style.property.modifier.start","style.property.modifier"]],[/\+(@id)/,"style.property.scope"],[/\s*([\:\=]\s*)(?=@br|$)/,"style.property.operator",{switchTo:"@>css_multiline_value&_stylevalue"}],[/\s*([\:\=]\s*)/,"style.property.operator",{switchTo:"@>css_value&_stylevalue"}]],css_value_:[[/(x?xs|sm\-?|md\-?|lg\-?|xx*l|\dxl|hg|x+h)\b/,"style.value.size"],[/\#[0-9a-fA-F]+/,"style.value.color.hex"],[/((--|\$)@id)/,"style.value.var"],[/(@optid)(\@+|\.+)(@optid)/,["style.property.name","style.property.modifier.prefix","style.property.modifier"]],"op_","string_","number_","comment_",[/\s+/,"style.value.white"],[/\(/,"delimiter.style.parens.open","@css_expressions"],[/\{/,"delimiter.style.curly.open","@css_interpolation&-_styleinterpolation"],[/(@id)/,"style.value"]],css_value:[A({switchTo:"@>css_multiline_value"},-1,-1),[/@cssPropertyKey/,"@rematch","@pop"],[/;/,"style.delimiter","@pop"],[/(\}|\)|\])/,"@rematch","@pop"],"css_value_"],css_multiline_value:[A(null,-1,0),[/@cssPropertyKey/,"invalid"],"css_value_"],css_expressions:[[/\)/,"delimiter.style.parens.close","@pop"],[/\(/,"delimiter.style.parens.open","@css_expressions"],"css_value"],css_interpolation:[[/\}/,"delimiter.style.curly.close","@pop"],"expr_"],expressions:[[/\,/,"delimiter.comma"]],whitespace:[[/[\r\n]+/,"br"],[/[ \t\r\n]+/,"white"]],space:[[/[ \t]+/,"white"]],tag_:[[/(\s*)(<)(?=\.)/,["white","tag.open","@_tag/flag"]],[/(\s*)(<)(?=\w|\{|\[|\%|\#|>)/,["white","tag.open","@_tag/name"]]],tag_content:[A(2,-1,0),[/\)|\}|\]/,"@rematch","@pop"],"common_","flow_","var_","for_","css_","expr_","do_"],tag_children:[],_tag:[[/\/>/,"tag.close","@pop"],[/>/,"tag.close",{switchTo:"@>tag_content=&-_tagcontent"}],[/>/,"tag.close","@pop"],[/(\-?\d+)/,"tag.$S3"],[/(\%)(@id)/,["tag.mixin.prefix","tag.mixin"]],[/\#@id/,"tag.id"],[/\./,{cases:{"$/==event":{token:"tag.event-modifier.start",switchTo:"@/event-modifier"},"$/==event-modifier":{token:"tag.event-modifier.start",switchTo:"@/event-modifier"},"$/==modifier":{token:"tag.modifier.start",switchTo:"@/modifier"},"$/==rule":{token:"tag.rule-modifier.start",switchTo:"@/rule-modifier"},"$/==rule-modifier":{token:"tag.rule-modifier.start",switchTo:"@/rule-modifier"},"@default":{token:"tag.flag.start",switchTo:"@/flag"}}}],[/(\$@id)/,{cases:{"$/==name":"tag.reference","@default":"tag.$/"}}],[/\{/,"tag.$/.interpolation.open","@_tag_interpolation"],[/\[/,"style.open","@css_inline"],[/(\s*\=\s*)/,"operator.equals.tagop.tag-$/","@_tag_value&-value"],[/\:/,{token:"tag.event.start",switchTo:"@/event"}],"tag_event_",[/(\-?@tagIdentifier)(\:@id)?/,{cases:{"$/==attr":{token:"@rematch",next:"@_tag_attr&-_tagattr"},"@default":{token:"tag.$/"}}}],[/\(/,{token:"tag.$/.parens.open",next:"@_tag_parens/0"}],[/\s+/,{token:"tag.white",switchTo:"@/attr"}],"comment_"],tag_event_:[[/(?=\@@optid)/,"","@_tag_event&-_listener"]],_tag_part:[[/\)|\}|\]|\>/,"@rematch","@pop"]],_tag_event:["_tag_part",[/(\@)(@optid)/,["tag.event.start","tag.event.name"]],[/(\.)(@optid)/,["tag.event-modifier.start","tag.event-modifier.name"]],[/\(/,{token:"tag.$/.parens.open",next:"@_tag_parens/0"}],[/(\s*\=\s*)/,"operator.equals.tagop.tag-$/","@_tag_value&handler"],[/\s+/,"@rematch","@pop"]],tag_attr_:[[/(?=@tagIdentifier(\:@id)?)/,"","@_tag_attr&-_attribute"]],_tag_attr:["_tag_part",[/(\-?@tagIdentifier)(\:@id)?/,"tag.attr"],[/\.(@optid)/,"tag.event-modifierzz"],[/\(/,{token:"tag.parens.open.$/",next:"@_tag_parens/0"}],[/(\s*\=\s*)/,"operator.equals.tagop.tag-$/","@_tag_value&-tagattrvalue"],[/\s+/,"@rematch","@pop"]],_tag_interpolation:[[/\}/,"tag.$/.interpolation.close","@pop"],"expr_",[/\)|\]/,"invalid"]],_tag_parens:[[/\)/,"tag.$/.parens.close","@pop"],"arglist_",[/\]|\}/,"invalid"]],_tag_value:[[/(?=(\/?\>|\s))/,"","@pop"],"attr_expr_"],regexp_:[[/\/(?!\ )(?=([^\\\/]|\\.)+\/)/,{token:"regexp.slash.open",bracket:"@open",next:"@_regexp"}],[/\/\/\//,{token:"regexp.slash.open",bracket:"@open",next:"@_hereregexp"}],[/(\/)(\/)/,["regexp.slash.open","regexp.slash.close"]]],_regexp:[[/(\{)(\d+(?:,\d*)?)(\})/,["regexp.escape.control","regexp.escape.control","regexp.escape.control"]],[/(\[)(\^?)(?=(?:[^\]\\\/]|\\.)+)/,["regexp.escape.control",{token:"regexp.escape.control",next:"@_regexrange"}]],[/(\()(\?:|\?=|\?!)/,["regexp.escape.control","regexp.escape.control"]],[/[()]/,"regexp.escape.control"],[/@regexpctl/,"regexp.escape.control"],[/[^\\\/]/,"regexp"],[/@regexpesc/,"regexp.escape"],[/\\:/,"regexp.escape"],[/\\\./,"regexp.invalid"],[/(\/)(\w+)/,[{token:"regexp.slash.close"},{token:"regexp.flags",next:"@pop"}]],["/",{token:"regexp.slash.close",next:"@pop"}],[/./,"regexp.invalid"]],_regexrange:[[/-/,"regexp.escape.control"],[/\^/,"regexp.invalid"],[/@regexpesc/,"regexp.escape"],[/[^\]]/,"regexp"],[/\]/,"regexp.escape.control","@pop"]],_hereregexp:[[/[^\\\/#]/,"regexp"],[/\\./,"regexp"],[/#.*$/,"comment"],["///[igm]*","regexp","@pop"],[/\//,"regexp"],"comment_"]};function _e(n){let e=["$S1","$S2","$S3","$S4","$S5","$S6"];if(n.match(/\@(pop|push|popall)/)||(n[0]=="@"&&(n=n.slice(1)),n.indexOf(".")>=0))return n;n=xe(n),n[0]==">"&&(e[1]="$S6	",n=n.slice(1));for(let t=0,r=I(n.split(/(?=[\/\&\=\*])/)),s=r.length;t<s;t++){let i=r[t];i[0]=="&"?i[1]=="-"||i[1]=="_"?e[2]="$S3"+i.slice(1):e[2]="$S3-"+i.slice(1):i[0]=="+"?e[3]="$S4-"+i.slice(1):i[0]=="="?e[3]=i.slice(1):i[0]=="/"?e[4]=i.slice(1):i[0]=="*"?e[5]=i.slice(1):e[0]=i}return e.join(".")}function xe(n){let e=n;return n=n.replace("$/","$S5"),n=n.replace("$F","$S4"),n=n.replace("$&","$S3"),n=n.replace("$I","$S2"),n=n.replace("$T","$S2"),n}function Ve(n,e){if(typeof n=="string"&&(n={token:n}),n&&n.token!=null)n.token=xe(n.token),typeof e=="string"?n.next=e:e&&Object.assign(n,e),n.next&&(n.next=_e(n.next)),n.switchTo&&(n.switchTo=_e(n.switchTo));else if(n&&n.cases){let t={};for(let r=n.cases,s=0,i=Object.keys(r),a=i.length,o,p;s<a;s++){o=i[s],p=r[o];let c=xe(o);t[c]=Ve(p)}n.cases=t}else if(R(n,Array)){let t=[],r=null;for(let s=0,i=I(n),a=i.length;s<a;s++){let o=i[s];o[0]=="@"&&s==n.length-1&&r&&(o={next:o}),typeof o=="object"?o.token!=null||o.cases?t.push(r=Object.assign({},o)):Object.assign(r,o):typeof o=="string"&&t.push(r={token:xe(o)})}n=t}if(R(n,Array))for(let t=0,r=I(n),s=r.length;t<s;t++){let i=r[t];i.token&&i.token.indexOf("$$")>=0&&(i.token=i.token.replace("$$","$"+(t+1))),i.next&&(i.next=_e(i.next)),i.switchTo&&(i.switchTo=_e(i.switchTo))}return n}for(let n=0,e=Object.keys(Ne),t=e.length,r,s;n<t;n++){r=e[n],s=Ne[r];let i=0;for(;i<s.length;){let a=s[i];if(R(a[0],Array)){s.splice(i,1,...a);continue}else typeof a=="string"?s[i]={include:a}:R(a[1],Array)?a[1]=Ve(a[1]):R(a,Array)&&a.splice(1,2,Ve(a[1],a[2]));i++}}var ke={defaultToken:"invalid",ignoreCase:!1,tokenPostfix:"",brackets:[{open:"{",close:"}",token:"bracket.curly"},{open:"[",close:"]",token:"bracket.square"},{open:"(",close:")",token:"bracket.parenthesis"}],keywords:["def","and","or","is","isnt","not","on","yes","@","no","off","true","false","null","this","self","as","new","delete","typeof","in","instanceof","return","throw","break","continue","debugger","if","elif","else","switch","for","while","do","try","catch","finally","class","extends","super","undefined","then","unless","until","loop","of","by","when","tag","prop","attr","export","import","extend","var","let","const","require","isa","await"],boolean:["true","false","yes","no","undefined","null"],operators:["=","!","~","?",":","!!","??","&","|","^","%","<<","!&",">>",">>>","+=","-=","*=","/=","&=","|=","??=","^=","%=","~=","<<=",">>=",">>>=","..","...","||=","&&=","**=","**","|=?","~=?","^=?","=?","and","or"],assignments:["=","|=?","~=?","^=?","=?","^=","%=","~=","<<=",">>=",">>>=","||=","&&=","??=","+=","-=","*=","/=","&=","|=","**="],logic:[">","<","==","<=",">=","!=","&&","||","===","!=="],ranges:["..","..."],spread:["..."],dot:["."],access:[".",".."],math:["+","-","*","/","++","--"],unspaced_ops:ks("... . .. + * ++ --"),comment:/#(\s.*)?(\n|$)/,symbols:/[=><!~?&%|+\-*\^,]+/,escapes:/\\(?:[abfnrtv\\"'$]|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,postaccess:/(:(?=\w))?/,ivar:/\@[a-zA-Z_]\w*/,B:/(?=\s|$)/,br:/[\r\n]+/,constant:/[A-Z][\w\$]*(?:\-+[\w\$]+)*/,id:/[A-Za-z_\$][\w\$]*(?:\-+[\w\$]+)*\??/,plainid:/[A-Za-z_\$][\w\$]*(?:\-+[\w\$]+)*\??/,fieldid:/[\@\#]*@plainid/,propid:/[\@\#]*@plainid/,defid:/[\@\#]*@plainid/,decid:/\@@plainid/,symid:/\#+@plainid/,symref:/\#\#@plainid/,optid:/(?:@id)?/,esmIdentifier:/[A-Za-z_\$\@][\w\$]*(?:\-+[\w\$]+)*\??/,propertyPath:/(?:[A-Za-z_\$][A-Za-z\d\-\_\$]*\.)?(?:[A-Za-z_\$][A-Za-z\d\-\_\$]*)/,tagNameIdentifier:/(?:[\w\-]+\:)?\w+(?:\-\w+)*/,variable:/[\w\$]+(?:-[\w\$]*)*\??/,varKeyword:/var|let|const/,tagIdentifier:/-*[a-zA-Z][\w\-]*/,implicitCall:/(?!\s(?:and|or|is|isa)\s)(?=\s[\w\'\"\/\[\{])/,cssModifier:/(?:\@+[\<\>\!]?[\w\-]+\+?|\.+@id\-?)/,cssPropertyPath:/[\@\.]*[\w\-\$]+(?:[\@\.]+[\w\-\$]+)*/,cssVariable:/(?:--|\$)[\w\-\$]+/,cssPropertyName:/[\w\-\$]+/,cssPropertyKey:/(?:@cssPropertyName(?:@cssModifier)*|@cssModifier+)(?:\s*[\:\=])/,cssUpModifier:/\.\.[\w\-\$]+/,cssIsModifier:/\.[\w\-\$]+/,regEx:/\/(?!\/\/)(?:[^\/\\]|\\.)*\/[igm]*/,regexpctl:/[(){}\[\]\$\^|\-*+?\.]/,regexpesc:/\\(?:[bBdDfnrstvwWn0\\\/]|@regexpctl|c[A-Z]|x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4})/,tokenizer:Ne};function ws(n){return Array.isArray(n)}function Ar(n){return!ws(n)}function Ke(n){return typeof n=="string"}function Er(n){return!Ke(n)}function Mr(n){return!n}function Y(n,e){return n.ignoreCase&&e?e.toLowerCase():e}function qe(n){return n.replace(/[&<>'"_]/g,"-")}function zr(n,e){console.log(`${n.languageId}: ${e}`)}function M(n,e){return new Error(`${n.languageId}: ${e}`)}var Br={};function $s(n){let e=[],t=0,r=n.length,s="",i=0;for(;t<r;){let a=n[t++];if(a=="$"){let o=n[t++];if(o=="$"){s+="$";continue}s&&e.push(s),s="",o=="#"?e.push(0):o=="S"?e.push(parseInt(n[t++])+100):e.push(parseInt(o)+1)}else s+=a}return s&&e.push(s),Br[n]=e,e}function Z(n,e,t,r,s){let i=null,a=Br[e]||$s(e),o="";for(let p=0;p<a.length;p++){let c=a[p];typeof c=="string"?o+=c:c>100?(i===null&&(i=s.split(".")),o+=i[c-101]||""):c===100?o+=s:c===0?o+=t:c>0&&(o+=r[c-1])}return o}var De={};function we(n,e){let t=e;if(De[t])return n.tokenizer[De[t]];for(;t&&t.length>0;){let r=n.tokenizer[t];if(r)return De[e]=t,r;let s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return null}function Lr(n,e){let t=e;for(;t&&t.length>0;){if(n.stateNames[t])return!0;let s=t.lastIndexOf(".");s<0?t=null:t=t.substr(0,s)}return!1}function Ss(n,e){if(!e||!Array.isArray(e))return!1;for(let t of e)if(!n(t))return!1;return!0}function Fr(n,e){return typeof n=="boolean"?n:e}function Rr(n,e){return typeof n=="string"?n:e}function Ts(n){let e={};for(let t of n)e[t]=!0;return e}function jr(n,e=!1){e&&(n=n.map(function(r){return r.toLowerCase()}));let t=Ts(n);return e?function(r){return t[r.toLowerCase()]!==void 0&&t.hasOwnProperty(r.toLowerCase())}:function(r){return t[r]!==void 0&&t.hasOwnProperty(r)}}function Ge(n,e){let t=0;for(;e.indexOf("@")>=0&&t<5;)t++,e=e.replace(/@(\w+)/g,function(r,s){let i="";if(typeof n[s]=="string")i=n[s];else if(n[s]&&n[s]instanceof RegExp)i=n[s].source;else throw n[s]===void 0?M(n,"language definition does not contain attribute '"+s+"', used at: "+e):M(n,"attribute reference '"+s+"' must be a string, used at: "+e);return Mr(i)?"":"(?:"+i+")"});return new RegExp(e,n.ignoreCase?"i":"")}function Cs(n,e,t,r){if(r<0)return n;if(r<e.length)return e[r];if(r>=100){r=r-100;let s=t.split(".");if(s.unshift(t),r<s.length)return s[r]}return null}function Is(n,e,t,r){let s=-1,i=t,a=t.match(/^\$(([sS]?)(\d\d?)|#)(.*)$/);a&&(a[3]&&(s=parseInt(a[3]),a[2]&&(s=s+100)),i=a[4]);let o="~",p=i;!i||i.length===0?(o="!=",p=""):/^\w*$/.test(p)?o="==":(a=i.match(/^(@|!@|~|!~|==|!=)(.*)$/),a&&(o=a[1],p=a[2]));let c;if((o==="~"||o==="!~")&&/^(\w|\|)*$/.test(p)){let l=jr(p.split("|"),n.ignoreCase);c=function(f){return o==="~"?l(f):!l(f)}}else if(o==="@"||o==="!@"){let l=n[p];if(!l)throw M(n,"the @ match target '"+p+"' is not defined, in rule: "+e);if(!Ss(function(u){return typeof u=="string"},l))throw M(n,"the @ match target '"+p+"' must be an array of strings, in rule: "+e);let f=jr(l,n.ignoreCase);c=function(u){return o==="@"?f(u):!f(u)}}else if(o==="~"||o==="!~")if(p.indexOf("$")<0){let l=Ge(n,"^"+p+"$");c=function(f){return o==="~"?l.test(f):!l.test(f)}}else c=function(l,f,u,h){return Ge(n,"^"+Z(n,p,f,u,h)+"$").test(l)};else if(p.indexOf("$")<0){let l=Y(n,p);c=function(f){return o==="=="?f===l:f!==l}}else{let l=Y(n,p);c=function(f,u,h,S,v){let E=Z(n,l,u,h,S);return o==="=="?f===E:f!==E}}return s===-1?{name:t,value:r,test:function(l,f,u,h){return c(l,l,f,u,h)}}:{name:t,value:r,test:function(l,f,u,h){let S=Cs(l,f,u,s);return c(S||"",l,f,u,h)}}}function He(n,e,t){if(t){if(typeof t=="string")return t;if(t.token||t.token===""){if(typeof t.token!="string")throw M(n,"a 'token' attribute must be of type string, in rule: "+e);{let r={token:t.token};if(t.token.indexOf("$")>=0&&(r.tokenSubst=!0),typeof t.bracket=="string")if(t.bracket==="@open")r.bracket=1;else if(t.bracket==="@close")r.bracket=-1;else throw M(n,"a 'bracket' attribute must be either '@open' or '@close', in rule: "+e);if(t.next){if(typeof t.next!="string")throw M(n,"the next state must be a string value in rule: "+e);{let s=t.next;if(!/^(@pop|@push|@popall)$/.test(s)&&(s[0]==="@"&&(s=s.substr(1)),s.indexOf("$")<0&&!Lr(n,Z(n,s,"",[],""))))throw M(n,"the next state '"+t.next+"' is not defined in rule: "+e);r.next=s}}return typeof t.goBack=="number"&&(r.goBack=t.goBack),typeof t.switchTo=="string"&&(r.switchTo=t.switchTo),typeof t.log=="string"&&(r.log=t.log),typeof t._push=="string"&&(r._push=t._push),typeof t._pop=="string"&&(r._pop=t._pop),typeof t.mark=="string"&&(r.mark=t.mark),typeof t.fn=="string"&&(r.fn=t.fn),typeof t.nextEmbedded=="string"&&(r.nextEmbedded=t.nextEmbedded,n.usesEmbedded=!0),r}}else if(Array.isArray(t)){let r=[];for(let s=0,i=t.length;s<i;s++)r[s]=He(n,e,t[s]);return{group:r}}else if(t.cases){let r=[];for(let i in t.cases)if(t.cases.hasOwnProperty(i)){let a=He(n,e,t.cases[i]);i==="@default"||i==="@"||i===""?r.push({test:void 0,value:a,name:i}):i==="@eos"?r.push({test:function(o,p,c,l){return l},value:a,name:i}):r.push(Is(n,e,i,a))}let s=n.defaultToken;return{test:function(i,a,o,p){for(let c of r)if(!c.test||c.test(i,a,o,p))return c.value;return s}}}else throw M(n,"an action must be a string, an object with a 'token' or 'cases' attribute, or an array of actions; in rule: "+e)}else return{token:""}}var Ze=class{constructor(e){this.regex=new RegExp("");this.action={token:""};this.matchOnlyAtLineStart=!1;this.name="";this.name=e,this.stats={time:0,count:0,hits:0}}setRegex(e,t){let r;if(typeof t=="string")r=t;else if(t instanceof RegExp)r=t.source;else throw M(e,"rules must start with a match string or regular expression: "+this.name);r.length==2&&r[0]=="\\"&&/[\{\}\(\)\[\]]/.test(r[1])&&(this.string=r[1]),this.matchOnlyAtLineStart=r.length>0&&r[0]==="^",this.name=this.name+": "+r,this.regex=Ge(e,"^(?:"+(this.matchOnlyAtLineStart?r.substr(1):r)+")")}setAction(e,t){this.action=He(e,this.name,t)}};function $e(n,e){if(!e||typeof e!="object")throw new Error("Monarch: expecting a language definition object");let t={};t.languageId=n,t.noThrow=!1,t.maxStack=100,t.start=typeof e.start=="string"?e.start:null,t.ignoreCase=Fr(e.ignoreCase,!1),t.tokenPostfix=Rr(e.tokenPostfix,"."+t.languageId),t.defaultToken=Rr(e.defaultToken,"source"),t.usesEmbedded=!1;let r=e;r.languageId=n,r.ignoreCase=t.ignoreCase,r.noThrow=t.noThrow,r.usesEmbedded=t.usesEmbedded,r.stateNames=e.tokenizer,r.defaultToken=t.defaultToken;function s(a,o,p){for(let c of p){let l=c.include;if(l){if(typeof l!="string")throw M(t,"an 'include' attribute must be a string at: "+a);if(l[0]==="@"&&(l=l.substr(1)),!e.tokenizer[l])throw M(t,"include target '"+l+"' is not defined at: "+a);s(a+"."+l,o,e.tokenizer[l])}else{let f=new Ze(a);if(Array.isArray(c)&&c.length>=1&&c.length<=3)if(f.setRegex(r,c[0]),c.length>=3)if(typeof c[1]=="string")f.setAction(r,{token:c[1],next:c[2]});else if(typeof c[1]=="object"){let u=c[1];u.next=c[2],f.setAction(r,u)}else throw M(t,"a next state as the last element of a rule can only be given if the action is either an object or a string, at: "+a);else f.setAction(r,c[1]);else{if(!c.regex)throw M(t,"a rule must either be an array, or an object with a 'regex' or 'include' field at: "+a);c.name&&typeof c.name=="string"&&(f.name=c.name),c.matchOnlyAtStart&&(f.matchOnlyAtLineStart=Fr(c.matchOnlyAtLineStart,!1)),f.setRegex(r,c.regex),f.setAction(r,c.action)}o.push(f)}}}if(!e.tokenizer||typeof e.tokenizer!="object")throw M(t,"a language definition must define the 'tokenizer' attribute as an object");t.tokenizer=[];for(let a in e.tokenizer)if(e.tokenizer.hasOwnProperty(a)){t.start||(t.start=a);let o=e.tokenizer[a];t.tokenizer[a]=new Array,s("tokenizer."+a,t.tokenizer[a],o)}if(t.usesEmbedded=r.usesEmbedded,e.brackets){if(!Array.isArray(e.brackets))throw M(t,"the 'brackets' attribute must be defined as an array")}else e.brackets=[{open:"{",close:"}",token:"delimiter.curly"},{open:"[",close:"]",token:"delimiter.square"},{open:"(",close:")",token:"delimiter.parenthesis"},{open:"<",close:">",token:"delimiter.angle"}];let i=[];for(let a of e.brackets){let o=a;if(o&&Array.isArray(o)&&o.length===3&&(o={token:o[2],open:o[0],close:o[1]}),o.open===o.close)throw M(t,"open and close brackets in a 'brackets' attribute must be different: "+o.open+`
 hint: use the 'bracket' attribute if matching on equal brackets is required.`);if(typeof o.open=="string"&&typeof o.token=="string"&&typeof o.close=="string")i.push({token:o.token+t.tokenPostfix,open:Y(t,o.open),close:Y(t,o.close)});else throw M(t,"every element in the 'brackets' array must be a '{open,close,token}' object or array")}return t.brackets=i,t.noThrow=!0,t}var D=class{constructor(e,t,r){this.offset=e|0,this.type=t,this.language=r,this.kind=0,this.mods=0,this.value=null,this.stack=null}toString(){return this.value||""}get span(){return{offset:this.offset,length:this.value?this.value.length:0}}get indent(){return 0}get startOffset(){return this.offset}get endOffset(){return this.offset+(this.value?this.value.length:0)}clone(){let e=new D(this.offset,this.type,this.language);return e.value=this.value,e.stack=this.stack,e}match(e){if(typeof e=="string")if(e.indexOf(" ")>0)e=e.split(" ");else{let t=this.type.indexOf(e);return e[0]=="."?t>=0:t==0}if(e instanceof Array)for(let t of e){let r=this.type.indexOf(t);if(t[0]=="."?r>=0:r==0)return!0}return e instanceof RegExp?e.test(this.type):!1}},ve=class{constructor(e,t){this.tokens=e,this.endState=t}};var Nr=10;function he(n,e){return n.split(".")[e]}var Ue=class{static create(e,t){return this._INSTANCE.create(e,t)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e,t){if(e!==null&&e.depth>=this._maxCacheDepth)return new X(e,t);let r=X.getStackElementId(e);r.length>0&&(r+="|"),r+=t;let s=this._entries[r];return s||(s=new X(e,t),this._entries[r]=s,s)}},ie=Ue;ie._INSTANCE=new Ue(Nr);var X=class{constructor(e,t){this.parent=e,this.state=t,this.depth=(this.parent?this.parent.depth:0)+1}static getStackElementId(e){let t="";for(;e!==null;)t.length>0&&(t+="|"),t+=e.state,e=e.parent;return t}static _equals(e,t){for(;e!==null&&t!==null;){if(e===t)return!0;if(e.state!==t.state)return!1;e=e.parent,t=t.parent}return e===null&&t===null}get indent(){return this.state.lastIndexOf("	")-this.state.indexOf("	")}get scope(){return this.part(2)}get detail(){return this.part(2)}part(e){return this.state.split(".")[e]}equals(e){return X._equals(this,e)}push(e){return ie.create(this,e)}pop(){return this.parent}popall(){let e=this;for(;e.parent;)e=e.parent;return e}switchTo(e){return ie.create(this.parent,e)}},Je=class{static create(e){return this._INSTANCE.create(e)}constructor(e){this._maxCacheDepth=e,this._entries=Object.create(null)}create(e){if(e!==null&&e.depth>=this._maxCacheDepth)return new ae(e);let t=X.getStackElementId(e),r=this._entries[t];return r||(r=new ae(e),this._entries[t]=r,r)}},oe=Je;oe._INSTANCE=new Je(Nr);var ae=class{constructor(e){this.stack=e}clone(){return oe.create(this.stack)}equals(e){return!(!(e instanceof ae)||!this.stack.equals(e.stack))}},We=class{constructor(){this._tokens=[],this._language=null,this._lastToken=new D(0,"start","imba"),this._lastTokenType=null}enterMode(e,t){this._language=t}emit(e,t,r){this._lastTokenType;let s=new D(e,t,this._language);return this._lastTokenType=t,this._lastToken=s,this._tokens.push(s),s}finalize(e){return new ve(this._tokens,e)}},le=class{constructor(e,t){this._modeId=e,this._lexer=t,this._profile=!1}dispose(){}getLoadStatus(){return{loaded:!0}}getInitialState(){let e=ie.create(null,this._lexer.start);return oe.create(e)}tokenize(e,t,r){let s=new We,i=this._tokenize(e,t,r,s);return s.finalize(i)}_tokenize(e,t,r,s){return this._myTokenize(e,t,r,s)}_safeRuleName(e){return e?e.name:"(unknown)"}_rescope(e,t,r,s){let i=(e||"").split("-"),a=(t||"").split("-");if(e==t)return;let o=1;for(;i[o]&&i[o]==a[o];)o++;let p=i.length;for(;p>o;)r.push("pop."+i[--p]+"."+p);for(;a.length>o;){let c="push."+a[o++]+"."+(o-1);if(s){let l=he(s,1);c+="."+l}r.push(c)}}_myTokenize(e,t,r,s){s.enterMode(r,this._modeId);let i=e.length,a=t.stack,o=null,p=0,c=this._profile,l=null,f=!0,u=[],h=0,S=[],v=null,E=-1;for(;f||p<i;){if(h++,h>1e3){if(p==E)throw console.log("infinite recursion",p,i,a,s),"infinite recursion in tokenizer?";E=p,h=0}let y=p,m=a.depth,_=l?l.groups.length:0,w=a.state,x=null,k=null,b=null,z=null;if(l){x=l.matches;let T=l.groups.shift();k=T.matched,b=T.action,z=l.rule,l.groups.length===0&&(l=null)}else{if(!f&&p>=i)break;if(f=!1,S=this._lexer.tokenizer[w],!S&&(S=we(this._lexer,w),!S))throw M(this._lexer,"tokenizer state is not defined: "+w);let T=e.substr(p);for(let C of S)if(C.string!==void 0){if(T[0]===C.string){x=[C.string],k=C.string,b=C.action;break}}else if(p===0||!C.matchOnlyAtLineStart){if(c){C.stats.count++;let q=performance.now();x=T.match(C.regex),C.stats.time+=performance.now()-q,x&&C.stats.hits++}else x=T.match(C.regex);if(x){k=x[0],b=C.action;break}}}if(x||(x=[""],k=""),b||(p<i&&(x=[e.charAt(p)],k=x[0]),b=this._lexer.defaultToken),k===null)break;for(p+=k.length;Ar(b)&&Er(b)&&b.test;)b=b.test(k,x,w,p===i);let O=null;if(typeof b=="string"||Array.isArray(b))O=b;else if(b.group)O=b.group;else if(b.token!==null&&b.token!==void 0){if(b.tokenSubst?O=Z(this._lexer,b.token,k,x,w):O=b.token,b.goBack&&(p=Math.max(0,p-b.goBack)),b.switchTo&&typeof b.switchTo=="string"){let T=Z(this._lexer,b.switchTo,k,x,w);if(T[0]==="@"&&(T=T.substr(1)),we(this._lexer,T)){let C=a.scope,q=he(T,2);C!==q&&this._rescope(C,q,u,T),a=a.switchTo(T)}else throw M(this._lexer,"trying to switch to a state '"+T+"' that is undefined in rule: "+this._safeRuleName(z))}else{if(b.transform&&typeof b.transform=="function")throw M(this._lexer,"action.transform not supported");if(b.next)if(b.next==="@push"){if(a.depth>=this._lexer.maxStack)throw M(this._lexer,"maximum tokenizer stack size reached: ["+a.state+","+a.parent.state+",...]");a=a.push(w)}else if(b.next==="@pop"){if(a.depth<=1)throw M(this._lexer,"trying to pop an empty stack in rule: "+this._safeRuleName(z));{let T=a;a=a.pop();let C=he(T.state,2),q=he(a.state,2);C!==q&&this._rescope(C,q,u,a.state)}}else if(b.next==="@popall")a=a.popall();else{let T=Z(this._lexer,b.next,k,x,w);T[0]==="@"&&(T=T.substr(1));let C=he(T,2);if(we(this._lexer,T))C!=a.scope&&this._rescope(a.scope||"",C,u,T),a=a.push(T);else throw M(this._lexer,"trying to set a next state '"+T+"' that is undefined in rule: "+this._safeRuleName(z))}}b.log&&typeof b.log=="string"&&zr(this._lexer,this._lexer.languageId+": "+Z(this._lexer,b.log,k,x,w)),b.mark&&s.emit(y+r,b.mark,a)}if(O===null)throw M(this._lexer,"lexer rule has no well-defined action in rule: "+this._safeRuleName(z));if(Array.isArray(O)){if(l&&l.groups.length>0)throw M(this._lexer,"groups cannot be nested: "+this._safeRuleName(z));if(x.length!==O.length+1)throw M(this._lexer,"matched number of groups does not match the number of actions in rule: "+this._safeRuleName(z));let T=0;for(let C=1;C<x.length;C++)T+=x[C].length;if(T!==k.length)throw M(this._lexer,"with groups, all characters should be matched in consecutive groups in rule: "+this._safeRuleName(z));l={rule:z,matches:x,groups:[]};for(let C=0;C<O.length;C++)l.groups[C]={action:O[C],matched:x[C+1]};p-=k.length;continue}else{if(O==="@rematch"&&(p-=k.length,k="",x=null,O=""),k.length===0)if(i===0||m!==a.depth||w!==a.state||(l?l.groups.length:0)!==_){for(typeof O=="string"&&O&&s.emit(p+r,O,a);u.length>0;)s.emit(p+r,u.shift(),a);continue}else throw M(this._lexer,"no progress in tokenizer in rule: "+this._safeRuleName(z));let T=null;if(Ke(O)&&O.indexOf("@brackets")===0){let q=O.substr(9),P=Os(this._lexer,k);if(!P)throw M(this._lexer,"@brackets token returned but no bracket defined as: "+k);T=qe(P.token+q)}else{let q=O===""?"":O+this._lexer.tokenPostfix;T=qe(q)}let C=s.emit(y+r,T,a);for(C.stack=a,o&&o!=C&&(o.value=e.slice(o.offset-r,y)),o=C;u.length>0;)s.emit(p+r,u.shift(),a)}}return o&&!o.value&&(o.value=e.slice(o.offset-r)),oe.create(a)}};function Os(n,e){if(!e)return null;e=Y(n,e);let t=n.brackets;for(let r of t){if(r.open===e)return{token:r.token,bracketType:1};if(r.close===e)return{token:r.token,bracketType:-1}}return null}var Vr=Symbol(),Te=class{constructor(e=null){this[F](e),N(this,Vr)}[F](e=null,t=!0,r=!0){this.offset=e?e.offset:void 0,this.text=e?e.text:void 0,this.tokens=e?e.tokens:void 0,this.startState=e?e.startState:void 0,this.endState=e?e.endState:void 0}clone(e=this.offset){let t=[],r=e-this.offset;for(let s=0,i=I(this.tokens),a=i.length;s<a;s++){let o=i[s],p=o.clone();p.offset=o.offset+r,t.push(p)}return new Te({offset:e,startState:this.startState,endState:this.endState,text:this.text,tokens:t})}},Se=Te;(()=>{$(Te,Vr,"LexedLine",16)})();var As=$e("imba",ke),ee=new le("imba",As);var ce=["comment","string","keyword","number","regexp","operator","namespace","type","struct","class","interface","enum","typeParameter","function","member","macro","variable","parameter","property","label"];for(let n=0,e=I(ce),t=e.length;n<t;n++){let r=e[n];ce[r]=n}var L={Declaration:1<<0,Import:1<<1,Export:1<<2,Global:1<<3,ReadOnly:1<<4,Static:1<<5,Modification:1<<6,Deprecated:1<<7,Access:1<<8,Root:1<<9,Special:1<<10,Class:1<<11,Member:1<<12,Function:1<<13,Def:1<<14,Var:1<<15,Let:1<<16,Const:1<<17,Get:1<<18,Set:1<<19},Dr=Object.keys(L).map(function(n){return n.toLowerCase()});for(let n=0,e=I(Object.keys(L)),t=e.length;n<t;n++){let r=e[n];L[r.toLowerCase()]=L[r]}var V={Keyword:1<<0,Access:1<<1,Key:1<<2,TagName:1<<3,TagEvent:1<<4,TagFlag:1<<5,TagProp:1<<6,TagEventModifier:1<<7,Value:1<<8,Path:1<<9,StyleProp:1<<10,StyleValue:1<<11,Type:1<<12,StyleModifier:1<<13,StyleSelector:1<<14,VarName:1<<15,ImportName:1<<16},g={Keyword:1<<0,Root:1<<1,Class:1<<2,Block:1<<3},me={and:g.Block,await:g.Block,begin:g.Block,break:g.Block,by:g.Block,case:g.Block,catch:g.Block,class:g.Block,const:g.Block,continue:g.Block,css:g.Class|g.Root,debugger:g.Block,def:g.Class|g.Block,get:g.Class,set:g.Class,delete:g.Block,do:g.Block,elif:g.Block,else:g.Block,export:g.Root,extends:g.Block,false:g.Block,finally:g.Block,for:g.Block,if:g.Block,import:g.Root,in:g.Block,instanceof:g.Block,is:g.Block,isa:g.Block,isnt:g.Block,let:g.Block,loop:g.Block,module:g.Block,nil:g.Block,no:g.Block,not:g.Block,null:g.Block,of:g.Block,or:g.Block,require:g.Block,return:g.Block,self:g.Block,static:g.Block|g.Class,super:g.Block,switch:g.Block,tag:g.Root,then:g.Block,this:g.Block,throw:g.Block,true:g.Block,try:g.Block,typeof:g.Block,undefined:g.Block,unless:g.Block,until:g.Block,var:g.Block,when:g.Block,while:g.Block,yes:g.Block},j={File:1,Module:2,Namespace:3,Package:4,Class:5,Method:6,Property:7,Field:8,Constructor:9,Enum:10,Interface:11,Function:12,Variable:13,Constant:14,String:15,Number:16,Boolean:17,Array:18,Object:19,Key:20,Null:21,EnumMember:22,Struct:23,Event:24,Operator:25,TypeParameter:26};for(let n=0,e=Object.keys(j),t=e.length,r,s;n<t;n++)r=e[n],s=j[r],j[s]=r;var de=Symbol.for("#datatype"),d={None:0,ConstVariable:1<<0,LetVariable:1<<1,Property:1<<2,EnumMember:1<<3,Function:1<<4,Class:1<<5,LocalComponent:1<<6,GlobalComponent:1<<7,RegularEnum:1<<8,ValueModule:1<<9,Parameter:1<<10,TypeLiteral:1<<11,ObjectLiteral:1<<12,Method:1<<13,Constructor:1<<14,GetAccessor:1<<15,SetAccessor:1<<16,Signature:1<<17,TypeParameter:1<<18,TypeAlias:1<<19,ExportValue:1<<20,Alias:1<<21,Prototype:1<<22,ExportStar:1<<23,Optional:1<<24,IsSpecial:1<<27,IsImport:1<<28,IsStatic:1<<29,IsGlobal:1<<30,IsRoot:1<<31};d.Component=d.LocalComponent|d.GlobalComponent;d.Variable=d.LetVariable|d.ConstVariable|d.Parameter;d.Accessor=d.GetAccessor|d.SetAccessor;d.ClassMember=d.Method|d.Accessor|d.Property;d.Scoped=d.Function|d.Variable|d.Class|d.Enum|d.LocalComponent;d.Type=d.Component|d.Class;d.GlobalVar=d.ConstVariable|d.IsGlobal;d.SpecialVar=d.ConstVariable|d.IsSpecial;var Kr=[["entity.name.component.local",0,d.LocalComponent],["entity.name.component.global",0,d.GlobalComponent],["entity.name.function",0,d.Function],["entity.name.class",0,d.Class],["entity.name.constructor",0,d.Method],["entity.name.def",0,d.Method],["entity.name.get",0,d.GetAccessor],["entity.name.set",0,d.SetAccessor],["field",0,d.Property],["decl-let",0,d.LetVariable],["decl-for-index",0,d.LetVariable,{datatype:"\\number"}],["decl-for",0,d.LetVariable,{kind:"for"}],["decl-var",0,d.LetVariable],["decl-param",0,d.Parameter],["decl-const",0,d.ConstVariable],["decl-import",0,d.ConstVariable|d.IsImport]],Xe={},qr=Symbol(),Qe=class{[F](e=null,t=!0,r=!0){var s;this.value=e?e.value:void 0,this.body=e&&(s=e.body)!==void 0?s:null}static typeMatch(e){if(Xe[e]!=null)return Xe[e];for(let t=0,r=I(Kr),s=r.length;t<s;t++){let[i,a,o,p]=r[t];if(e.indexOf(i)>=0)return Xe[e]=Kr[t]}return null}static forToken(e,t,r=0){let s=this.typeMatch(t);return s?new this(s[2],e.value,e,s[3]):null}constructor(e,t,r,s=null){this[F](),this.flags=e,this.name=t,this.node=r,this.desc=s,N(this,qr)}get importSource(){return this.importedÎ¦?this.node.context.closest("imports").sourcePath:null}get exportName(){return this.node.prev.match("keyword.as")?this.node.prev.prev.value:this.node.match(".default")?"default":this.node.value}get importInfo(){if(!this.importedÎ¦)return null;let e=this.node.context.closest("imports");return{exportName:this.exportName,name:this.node.value,isTypeOnly:e.isTypeOnly,path:e.sourcePath}}get datatype(){let e,t=this.desc&&this.desc.datatype;if(t)return t;if(this[de])return this[de];let r=this.node&&this.node.nextNode;if(r&&r.type=="type")return r;let s=this.scope;if(s&&this.desc?.kind=="for"){let i=s.doc.getDestructuredPath(this.node,[[s.expression,"__@iterable"]]);return this[de]||(this[de]=i)}return(e=this.importInfo)?e:null}get staticÎ¦(){return this.node&&this.node.mods&L.Static}get itervarÎ¦(){return this.node&&this.node.match(".decl-for")}get variableÎ¦(){return this.flags&d.Variable}get parameterÎ¦(){return this.flags&d.Parameter}get memberÎ¦(){return this.flags&d.ClassMember}get scopedÎ¦(){return this.flags&d.Scoped}get typeÎ¦(){return this.flags&d.Type}get globalÎ¦(){return this.flags&d.IsGlobal}get importedÎ¦(){return this.flags&d.IsImport}get componentÎ¦(){return this.flags&d.Component}get escapedName(){return this.name}get scope(){return this.node?.context?.scope}addReference(e){return this.references||(this.references=[]),this.references.push(e),e.symbol=this,this}dereference(e){let t=this.references.indexOf(e);return t>=0&&(e.symbol=null,this.references.splice(t,1)),this}get kind(){return this.variableÎ¦?j.Variable:this.flags&d.Class?j.Class:this.flags&d.Component?j.Class:this.flags&d.Property?j.Field:this.flags&d.Method?this.escapedName=="constructor"?j.Constructor:j.Method:this.flags&d.Function?j.Function:j.Method}get semanticKind(){return this.flags&d.Parameter?"parameter":this.variableÎ¦?"variable":this.typeÎ¦?"type":this.flags&d.Function?"function":this.memberÎ¦?"member":this.componentÎ¦?"component":"variable"}get semanticFlags(){let e=0;return this.flags&d.ConstVariable&&(e|=L.ReadOnly),this.staticÎ¦&&(e|=L.Static),this.flags&d.IsImport&&(e|=L.Import),this.flags&d.IsGlobal&&(e|=L.Global),this.flags&d.IsRoot&&(e|=L.Root),this.flags&d.IsSpecial&&(e|=L.Special),e}},G=Qe;(()=>{$(Qe,qr,"Sym",16)})();var Es=Symbol(),Ye=class extends G{},Gr=Ye;(()=>{$(Ye,Es,"ForVar",0)})();var Ms=Symbol(),et=class{},Hr=et;(()=>{$(et,Ms,"SymbolMap",0)})();var Zr={global:{datatype:"globalThis"},imba:{datatype:"globalThis.imba"},module:{},window:{datatype:"globalThis.window"},document:{datatype:"globalThis.document"},exports:{},console:{datatype:"globalThis.console"},process:{datatype:"globalThis.process"},parseInt:{datatype:"globalThis.parseInt"},parseFloat:{datatype:"globalThis.parseFloat"},setTimeout:{datatype:"globalThis.setTimeout"},setInterval:{datatype:"globalThis.setInterval"},setImmediate:{datatype:"globalThis.setImmediate"},clearTimeout:{datatype:"globalThis.clearTimeout"},clearInterval:{datatype:"globalThis.clearInterval"},clearImmediate:{datatype:"globalThis.clearImmediate"},globalThis:{datatype:"globalThis"},isNaN:{datatype:"globalThis.isNaN"},isFinite:{datatype:"globalThis.isFinite"},__dirname:{datatype:"\\string"},__filename:{datatype:"\\string"},__realname:{datatype:"\\string"}},Wr=Symbol(),Tt=class{[F](e=null,t=!0,r=!0){var s;this.type=e&&(s=e.type)!==void 0?s:"",this.start=e?e.start:void 0,this.end=e?e.end:void 0,this.parent=e?e.parent:void 0}static build(e,t,r,s,i){return new this(e,t,r,s,i)}constructor(e,t,r,s){this[F](),this.doc=e,this.start=t,this.end=null,this.type=s,this.parent=r,this.$name=null,t.scope=this,N(this,Wr)}pop(e){return this.end=e,e.start=this.start,e.pops=this,this.start.end=e,this.visit(),this.parent}find(e){return this.findChildren(e,!0)[0]}get childNodes(){return this.doc.getNodesInScope(this)}findChildren(e,t=!1){let r=[],s=this.start;for(;s;){if(t&&r.length)return r;if(s.scope&&s.scope!=this){s.scope.match(e)&&r.push(s.scope),s=s.scope.next;continue}if(s.match(e)&&r.push(s),s==this.end)break;s=s.next}return r}closest(e){return this.match(e)?this:this.parent?this.parent.closest(e):null}visit(){return this}get memberÎ¦(){return!1}get topÎ¦(){return!1}get selfScope(){return this.memberÎ¦||this.topÎ¦?this:this.parent.selfScope}get name(){return this.$name||""}get value(){return this.doc.content.slice(this.start.offset,this.next?this.next.offset:-1)}get next(){return this.end?this.end.next:null}get prev(){return this.start?this.start.prev:null}match(e){return typeof e=="string"?this.type==e:R(e,RegExp)?e.test(this.type):R(e,Function)?e(this):!0}},pe=Tt;(()=>{$(Tt,Wr,"Node",16)})();var Ur=Symbol(),Ct=class extends pe{constructor(e,t,r,s,i=[]){super(e,t,r,s),N(this,Ur)}get scope(){return this.parent.scope}get varmap(){return this.parent.varmap}register(e){return this.parent.register(e)}lookup(...e){return this.parent.lookup(...e)}},B=Ct;(()=>{$(Ct,Ur,"Group",16)})();var zs=Symbol(),It=class extends B{},tt=It;(()=>{$(It,zs,"ValueNode",0)})();var Bs=Symbol(),Ot=class extends B{},rt=Ot;(()=>{$(Ot,Bs,"StringNode",0)})();var Ls=Symbol(),At=class extends B{get properties(){return this.findChildren("styleprop")}},st=At;(()=>{$(At,Ls,"StyleNode",0)})();var Ps=Symbol(),Et=class extends B{},nt=Et;(()=>{$(Et,Ps,"StyleRuleNode",0)})();var Jr=Symbol(),Mt=class extends pe{constructor(e,t,r,s,i=[]){if(super(e,t,r,s),this.children=[],this.entities=[],this.refs=[],this.varmap=Object.create(r?r.varmap:{}),R(this,te))for(let a=0,o=Object.keys(Zr),p=o.length,c,l;a<p;a++){c=o[a],l=Zr[c];let f={value:c,offset:-1,mods:0};this.varmap[c]=new G(d.GlobalVar,c,f,l)}return this.indent=i[3]&&i[3][0]=="	"?i[3].length:0,this.setup(),this;N(this,Jr)}setup(){if(this.handlerÎ¦&&(this.varmap.e=new G(d.SpecialVar,"e",null,"eventReference")),(this.classÎ¦||this.propertyÎ¦)&&(this.ident=this.token=be(this.start,"entity."),this.ident&&(this.ident.body=this),this.ident&&this.ident.type=="entity.name.def.render"&&(this.$name="render",this.ident.symbol)))return this.ident.symbol.name="render"}get selfPath(){let e=this.path;return this.propertyÎ¦?e.slice(0,e.lastIndexOf(".")):e}get path(){let e=this.parent?this.parent.path:"";if(this.propertyÎ¦){let t=this.staticÎ¦?".":".prototype.";return this.parent?""+this.parent.path+t+this.name:this.name}return this.componentÎ¦?this.name[0]==this.name[0].toLowerCase()?this.name.replace(/\-/g,"_")+"$$TAG$$":this.name:this.classÎ¦?this.name:e}get allowedKeywordTypes(){return this.classÎ¦?g.Class:this.rootÎ¦?g.Root|g.Block:g.Block}get componentÎ¦(){return!!this.type.match(/^component/)}get rootÎ¦(){return R(this,te)}get topÎ¦(){return R(this,te)}get classÎ¦(){return!!this.type.match(/^class/)||this.componentÎ¦}get defÎ¦(){return!!this.type.match(/def|get|set/)}get staticÎ¦(){return!!(this.ident&&this.ident.mods&L.Static)}get handlerÎ¦(){return!!this.type.match(/handler|spy/)}get memberÎ¦(){return!!this.type.match(/def|get|set/)}get propertyÎ¦(){return!!this.type.match(/def|get|set|field/)}get flowÎ¦(){return!!this.type.match(/if|else|elif|unless|for|while|until/)}get closureÎ¦(){return!!this.type.match(/class|component|def|get|set|do/)}get scope(){return this}get name(){return this.$name||(this.ident?this.ident.value:"")}visit(){return this}register(e){return e.scopedÎ¦&&(this.varmap[e.name]=e,this.rootÎ¦&&(e.flags|=d.IsRoot)),e}lookup(e,t=d.Scoped){let r,s=e.value;return s[s.length-1]=="!"&&(s=s.slice(0,-1)),(r=this.varmap[s])?r:null}toOutline(){return{kind:this.type,name:this.name,children:[],span:this.ident?this.ident.span:this.start.span}}},K=Mt;(()=>{$(Mt,Jr,"Scope",16)})();var Fs=Symbol(),zt=class extends K{},te=zt;(()=>{$(zt,Fs,"Root",0)})();var Rs=Symbol(),Bt=class extends K{},Xr=Bt;(()=>{$(Bt,Rs,"Class",0)})();var js=Symbol(),Lt=class extends K{},Qr=Lt;(()=>{$(Lt,js,"Method",0)})();var Ns=Symbol(),Pt=class extends K{},Yr=Pt;(()=>{$(Pt,Ns,"Flow",0)})();var Vs=Symbol(),Ft=class extends K{get expression(){return this.find("keyword.in keyword.of").next.next}get forvars(){return Object.values(this.varmap).filter(function(e){return e.itervarÎ¦})}},it=Ft;(()=>{$(Ft,Vs,"ForScope",0)})();var Ds=Symbol(),Rt=class extends K{register(e){return this.parent.register(e)}lookup(...e){return this.parent.lookup(...e)}},ot=Rt;(()=>{$(Rt,Ds,"WeakScope",0)})();var Ks=Symbol(),jt=class extends K{get selfScope(){return this}},at=jt;(()=>{$(jt,Ks,"FieldScope",0)})();var qs=Symbol(),Nt=class extends B{},lt=Nt;(()=>{$(Nt,qs,"SelectorNode",0)})();var Gs=Symbol(),Vt=class extends B{get propertyName(){return this.start.next.match("style.property.name")?this.start.next.value:this.parent.prevProperty?.propertyName}get modifier(){if(this.start.next.match("style.property.modifier"))return this.start.next.value}get styleValue(){return!0}},ct=Vt;(()=>{$(Vt,Gs,"StylePropKey",0)})();var Hs=Symbol(),Dt=class extends B{get key(){return this.parent.key}get propertyName(){return this.parent.propertyName}get modifier(){return this.parent.modifier}},pt=Dt;(()=>{$(Dt,Hs,"StylePropValue",0)})();var Zs=Symbol(),Kt=class extends B{get key(){return this.find("stylepropkey")}get prevProperty(){return this.start.prev.pops?this.start.prev.pops:null}get propertyName(){return this.key?.propertyName}get modifier(){return this.key?.modifier}},ft=Kt;(()=>{$(Kt,Zs,"StylePropNode",0)})();var Ws=Symbol(),qt=class extends B{},ut=qt;(()=>{$(qt,Ws,"StyleInterpolation",0)})();var Us=Symbol(),Gt=class extends B{get innerText(){return this.value.slice(1,-1)}},ht=Gt;(()=>{$(Gt,Us,"PathNode",0)})();var Js=Symbol(),Ht=class extends B{get name(){let e=this.findChildren("tag.name").join("");return e=="self"?this.closest("component").name:e}get localÎ¦(){return this.name[0]==this.name[0].toUpperCase()}get tagName(){return this.name}get parentTag(){return this.closest("tagcontent")?.ownerTag}get ancestorTags(){return this.closest("tagcontent")?.ownerTags}get ancestorPath(){return this.ancestorTags.map(function(e){return e.tagName}).join(".")}get pathName(){return"<"+this.name+">"}get outline(){return this.findChildren(/tag\.(reference|name|id|white|flag|event(?!\-))/).join("")}},mt=Ht;(()=>{$(Ht,Js,"TagNode",0)})();var Xs=Symbol(),Zt=class extends B{get propertyName(){return this.start.next.match("tag.attr")?this.start.next.value:""}get tagName(){return this.parent.name}},dt=Zt;(()=>{$(Zt,Xs,"TagAttrNode",0)})();var Qs=Symbol(),Wt=class extends B{get propertyName(){return this.parent.propertyName}get tagName(){return this.parent.tagName}},gt=Wt;(()=>{$(Wt,Qs,"TagAttrValueNode",0)})();var Ys=Symbol(),Ut=class extends ot{get ownerTag(){return this.start.prev.pops}get ownerTags(){let e=[this.ownerTag],t;for(;t=e[0].parentTag;)e.unshift(t);return e}},yt=Ut;(()=>{$(Ut,Ys,"TagContent",0)})();var en=Symbol(),Jt=class extends B{get name(){return this.findChildren("tag.event.name").join("").replace("@","")}},bt=Jt;(()=>{$(Jt,en,"Listener",0)})();var tn=Symbol(),Xt=class extends B{},Ce=Xt;(()=>{$(Xt,tn,"ParensNode",0)})();var rn=Symbol(),Qt=class extends B{static build(e,t,r,s,i){let a=this,o=e.content[t.offset-1];return!o||` [{(|=&-;
	:/*%+-`.indexOf(o)>=0?(s="array",a=xt):(s="index",a=kt),new a(e,t,r,s,i)}},fe=Qt;(()=>{$(Qt,rn,"BracketsNode",0)})();var sn=Symbol(),Yt=class extends B{},ge=Yt;(()=>{$(Yt,sn,"BracesNode",0)})();var nn=Symbol(),er=class extends ge{},_t=er;(()=>{$(er,nn,"SpecifiersNode",0)})();var on=Symbol(),tr=class extends fe{get delimiters(){return this.childNodes.filter(function(e){return e.match("delimiter")})}indexOfNode(e){var t;let r=this.delimiters,s=0;t=0;for(let i of I(r)){let a=t++;e.offset>i.offset&&s++}return s}},xt=tr;(()=>{$(tr,on,"ArrayNode",0)})();var an=Symbol(),rr=class extends fe{},kt=rr;(()=>{$(rr,an,"IndexNode",0)})();var es=Symbol(),sr=class extends B{constructor(){super(...arguments),this.prev.datatype=this,N(this,es)}toString(){return this.value}},wt=sr;(()=>{$(sr,es,"TypeAnnotationNode",16)})();var ln=Symbol(),nr=class extends B{},$t=nr;(()=>{$(nr,ln,"InterpolatedValueNode",0)})();var cn=Symbol(),ir=class extends ge{},vt=ir;(()=>{$(ir,cn,"ObjectNode",0)})();var pn=Symbol(),or=class extends B{get isTypeOnly(){return this.start.prev.match("keyword.type")}get sourcePath(){return this.childNodes.find(function(t){return t.match("path")})?.innerText}get specifiers(){return this.childNodes.find(function(e){return e.match("specifiers")})}get default(){return this.childNodes.find(function(e){return e.match(".default")})}get namespace(){return this.childNodes.find(function(e){return e.match(".ns")})}},St=or;(()=>{$(or,pn,"ImportsNode",0)})();var W={style:st,array:fe,stylerule:nt,sel:lt,path:ht,value:tt,tag:mt,forscope:it,field:at,type:wt,parens:Ce,brackets:fe,object:vt,braces:ge,specifiers:_t,string:rt,tagattr:dt,imports:St,interpolation:$t,tagattrvalue:gt,tagcontent:yt,listener:bt,styleinterpolation:ut,styleprop:ft,stylepropkey:ct,stylevalue:pt,args:Ce};var ar=Symbol.for("#ins"),lr=Symbol.for("#del"),ts=Symbol.for("#version"),rs=Symbol.for("#multiline"),ss=Symbol.for("#significant"),cr=Symbol.for("#body"),re=Symbol.for("#lexed"),fn=Symbol(),pr=class{get node(){return this.scope&&this.scope.start==this?this.scope:this.pops?this.pops:this}get nextNode(){return this.next?.node}get prevNode(){return this.prev?.node}},ns=pr;(()=>{$(pr,fn,"Token",1,D)})();var is=Symbol(),Oe=class{static tmp(e){return new this("file://temporary.imba","imba",0,e)}static from(e,t,r,s){return new this(e,t,r,s)}constructor(e,t,r,s){this.uri=e,this.languageId=t,this.version=r,this.content=s,this.connection=null,this.lineTokens=[],this.isLegacy=t=="imba1"||e&&e.match(/\.imba1$/),this.head=this.seed=new D(0,"eol","imba"),this.initialState=ee.getInitialState(),this.seed.stack=ee.getInitialState(),this.history=[],this.lexer=ee,this.versionToHistoryMap={},this.versionToHistoryMap[r]=-1,s&&s.match(/^\#[^\n]+imba1/m)&&(this.isLegacy=!0),N(this,is)}log(...e){return console.log(...e)}get lineCount(){return this.lineOffsets.length}get lineOffsets(){return this._lineOffsets||(this._lineOffsets=Fe(this.content,!0))}getText(e=null){if(e){let t=this.offsetAt(e.start),r=this.offsetAt(e.end);return this.content.substring(t,r)}return this.content}getLineText(e){let t=this.lineOffsets[e],r=this.lineOffsets[e+1];return this.content.substring(t,r).replace(/[\r\n]/g,"")}positionAt(e){if(R(e,J))return e;typeof e=="object"&&(e=e.offset),e=Math.max(Math.min(e,this.content.length),0);let t=this.lineOffsets,r=0,s=t.length;if(s===0)return new J(0,e,e,this.version);for(;r<s;){let a=Math.floor((r+s)/2);t[a]>e?s=a:r=a+1}let i=r-1;return new J(i,e-t[i],e,this.version)}offsetAt(e){if(e.offset)return e.offset;let t=this.lineOffsets;if(e.line>=t.length)return this.content.length;if(e.line<0)return 0;let r=t[e.line],s=e.line+1<t.length?t[e.line+1]:this.content.length;return e.offset=Math.max(Math.min(r+e.character,s),r)}rangeAt(e,t=e){return new H(this.positionAt(e),this.positionAt(t))}overwrite(e,t){return this.version=t||this.version+1,this.content=e,this._lineOffsets=null,this.invalidateFromLine(0),this}update(e,t){t==null&&(t=this.version+1);let r=[],s=!1;r[ar]="",r[lr]="";for(let o=0,p=I(e),c=p.length;o<c;o++){let l=p[o];if(Sr(l)){this.overwrite(l.text,t),r.push([0,this.content.length,l.text]),s=!0;continue}let f=vr(l.range),u=this.offsetAt(f.start),h=this.offsetAt(f.end);l.range=f,l.offset=u,l.length=h-u,f.start.offset=u,f.end.offset=h;let v=h-u?this.content.slice(u,h):"";r[lr]+=v,r[ar]+=l.text||"",this.applyEdit(l,t,e),r.push([u,h-u,l.text||"",v]);let E=Math.max(f.start.line,0),y=Math.max(f.end.line,0),m=this.lineOffsets,_=Fe(l.text,!1,u);if(y-E===_.length)for(let x=0,k=I(_),b=k.length;x<b;x++){let z=k[x];m[x+E+1]=_[o]}else _.length<1e4?m.splice.apply(m,[E+1,y-E].concat(_)):this._lineOffsets=m=m.slice(0,E+1).concat(_,m.slice(y+1));let w=l.text.length-(h-u);if(w!==0){let x=E+1+_.length;for(;x<m.length;)m[x]=m[x]+w,x++}}this.history.push(r),r[ts]=t;let i=this.history[this.history.length-2];return(r[ar]+r[lr]).indexOf(`
`)>=0&&(r[rs]=!0,i&&!i[rs]&&(r[ss]=!0,r[cr]=this.content)),this.versionToHistoryMap[t]=this.history.length-1,this.updated(e,t)}get lastSignificantVersion(){let e=this.history.length;for(;e>0;){let t=this.history[--e];if(t&&t[ss])return t[ts]}return null}editsSinceVersion(e){let t=this.versionToHistoryMap[e],r=[];for(let s=0,i=I(this.history.slice(t+1)),a=i.length;s<a;s++){let o=i[s];r.push(...o)}return r}contentAtVersion(e){let t=this.versionToHistoryMap[e],r=this.history[t];return r[cr]!=null?r[cr]:null}offsetAtVersion(e,t,r=this.version,s=!1){let i=this.versionToHistoryMap[t],a=this.versionToHistoryMap[r],o=e,p=!1;if(i<a)for(;i<a;){let c=this.history[++i];for(let l=0,f=I(c),u=f.length;l<u;l++){let[h,S,v]=f[l];h>o||(s&&(h-=1),o>h&&o>h+S&&(o+=v.length-S))}}else if(a<i)for(;a<i;){let c=this.history[i--];for(let l=0,f=I(c),u=f.length;l<u;l++){let[h,S,v]=f[l];h>o||o>h&&o>h+S&&(o-=v.length-S)}}return o}historicalOffset(e,t){return this.offsetAtVersion(e,this.version,t,!0)}applyEdit(e,t,r){this.content=this.content.substring(0,e.range.start.offset)+e.text+this.content.substring(e.range.end.offset,this.content.length);let s=e.range.start.line;this.invalidateFromLine(s)}updated(e,t){return this.version=t,this}invalidateFromLine(e){return this.head=this.seed,this}after(e,t){let r=this.tokens.indexOf(e);if(t){for(;r<this.tokens.length;){let s=this.tokens[++r];if(s&&this.matchToken(s,t))return s}return null}return this.tokens[r+1]}matchToken(e,t){return R(t,RegExp)?e.type.match(t):typeof t=="string"?e.type==t:!1}before(e,t,r=0){let s=this.tokens.indexOf(e)+r;if(t){for(;s>0;){let i=this.tokens[--s];if(this.matchToken(i,t))return i}return null}return this.tokens[s-1]}getTokenRange(e){return{start:this.positionAt(e.offset),end:this.positionAt(e.offset+e.value.length)}}getTokensInScope(e){let t=this.tokens.indexOf(e.start),r=e.end?this.tokens.indexOf(e.end):this.tokens.length,s=t,i=[];for(;s<r;){let a=this.tokens[s++];a.scope&&a.scope!=e?(i.push(a.scope),s=a.scope.endIndex+1):i.push(a)}return i}getSymbols(){var e;return this.astify(),(e=this[re]).symbols||(e.symbols=this.tokens.map(function(t){return t.symbol}).filter(function(t){return t}).filter(function(t,r,s){return s.indexOf(t)==r}))}getImportedSymbols(){return this.getSymbols().filter(function(e){return e.importedÎ¦})}getImportNodes(){return this.tokens.filter(function(t){return t.match("push._imports")}).map(function(t){return t.scope})}getNodesInScope(e,t=!1){let r=e.start,s=e.end;t?s=s.next:r=r.next;let i=[];for(;r&&r!=s;){if(r.scope&&r.scope!=e){i.push(r.scope),r=r.scope.end.next;continue}else r.type!="white"&&i.push(r);r=r.next}return i}getTokenAtOffset(e,t=!1){return this.tokenAtOffset(e)}getSemanticTokens(e=d.Scoped){let t=this.parse(),r=[];for(let s=0,i=I(t),a=i.length;s<a;s++){let o=i[s],p=o.symbol;if(!(p&&(!e||p.flags&e)))continue;let c=ce[p.semanticKind],l=o.mods|p.semanticFlags;r.push([o.offset,o.value.length,c,l])}return r}getEncodedSemanticTokens(){let e=this.getSemanticTokens(),t=[],r=0,s=0;for(let i=0,a=I(e),o=a.length;i<o;i++){let p=a[i],c=this.positionAt(p[0]),l=c.line-r,f=l?c.character:c.character-s;t.push(l,f,p[1],p[2],p[3]),r=c.line,s=c.character}return t}getDestructuredPath(e,t=[],r=null){if(e.context.type=="array")return this.getDestructuredPath(e.context.start,t,r),t.push(e.context.indexOfNode(e)),t;let s=e.value;return e.prev.match("operator.assign.key-value")&&(s=e.prev.prev.value),e.context.type=="object"&&(this.getDestructuredPath(e.context.start,t,r),t.push(s)),t}tokenAtOffset(e){let t=this.tokens[0];for(;t;){let r=t.next;if(t.offset>=e)return t.prev;if(t.end&&t.end.offset<e)t=t.end;else if(r)t=r;else return t}return t}patternAtOffset(e,t=/[\w\-\.\%]/){let r=e,s=e,i=this.content;for(;r>0&&t.test(this.content[r-1]);)r--;for(;t.test(this.content[s+1]||"");)s++;return[i.slice(r,s+1),r,s]}adjustmentAtOffset(e,t=1){let[r,s,i]=this.patternAtOffset(e),[a,o=""]=r.split(/[\d\.]+/),p=parseFloat(r.slice(a.length).slice(0,o.length?-o.length:1e3));return Number.isNaN(p)?null:(p+=t,[s+a.length,r.length-a.length-o.length,String(p)])}contextAtOffset(e){var t;this.ensureParsed();let r=this.positionAt(e),s=this.tokenAtOffset(e),i=this.lineOffsets[r.line],a=e-s.offset,o=s.context,p={character:this.content[e-1],line:this.content.slice(i,e),token:s.value.slice(0,a)},c={character:this.content[e],token:s.value.slice(a),line:this.content.slice(e,this.lineOffsets[r.line+1]).replace(/[\r\n]+/,"")};s.scope&&!c.token&&(o=s.scope),s.next&&s.next.value==null&&s.next.scope&&!c.token&&s.match("operator.assign")&&(o=s.next.scope);let l=be(s,"white.tabs"),f=l?l.value.length:0,u=o,h=o.scope,S={},v=s,E=s.stack.state||"",y=V;u&&(u.start&&(p.group=this.content.slice(u.start.offset,e)),u.end&&(c.group=this.content.slice(e,u.end.offset)));let m={keywords:[]},_=0;if(s==l&&(f=a),s.match("br white.tabs"))for(;h.indent>f;)h=h.parent;if(u.type=="tag",s.match("entity string regexp comment style.")&&(_=0),s.match("tag.event.name tag.event-modifier.name")&&(v=s.prev),(s.type=="path"||s.type=="path.open")&&(_|=V.Path,m.paths=1),s.match("identifier tag.operator.equals br white delimiter array operator ( self")&&(_|=V.Value,v=null),s.match("operator.access")&&(_|=V.Access,v=s),s.match("accessor")&&(_|=V.Access,v=s.prev),s.match("delimiter.type.prefix type")&&(_|=V.Type),s.match("tag.name tag.open")?_|=V.TagName:s.match("tag.attr tag.white")?_|=V.TagProp:s.match("tag.flag")?_|=V.TagFlag:s.match("tag.event.modifier")?_|=V.TagEventModifier:s.match("tag.event")?_|=V.TagEvent:s.match("operator.equals.tagop")&&(_|=V.Value),s.match("style.property.operator")||u.closest("stylevalue")){_|=y.StyleValue;try{m.styleProperty=u.closest("styleprop").propertyName}catch{}}s.match("style.open style.property.name")&&(_|=y.StyleProp),(s.match("style.value.white")||s.prev&&s.prev.match("style.value.white"))&&(_|=y.StyleProp),s.match("style.selector.element")&&c.line.match(/^\s*$/)&&(_|=y.StyleProp),h.closest("rule")&&(_|=y.StyleProp,_&=~y.Value),s.match("style.property.operator")&&(_&=~y.StyleProp),u.match("stylevalue")&&p.group.indexOf(" ")==-1&&(_=y.StyleValue),s.match("style.selector.modifier style.property.modifier")&&(_=y.StyleModifier),s.match("style.selector.element")&&(_|=y.StyleSelector),h.closest("rule")&&p.line.match(/^\s*$/)&&(_|=y.StyleSelector,_&=~y.StyleValue),s.match("operator.access accessor white.classname white.tagname")&&(_&=~y.Value),u.closest("imports")&&(_&=~y.Value,_|=y.ImportName),(E.match(/\.decl-(let|var|const|param|for)/)||s.match(/\.decl-(for|let|var|const|param)/))&&(_&=~y.Value,_|=y.VarName);let w=h.allowedKeywordTypes;t=[];for(let k=0,b=Object.keys(me),z=b.length,O,T;k<z;k++)O=b[k],T=me[O],T&w&&t.push(O);m.keywords=t,m.flags=_;for(let k=0,b=Object.keys(y),z=b.length,O,T;k<z;k++)O=b[k],T=y[O],_&T&&(m[O]||(m[O]=!0));return{token:s,offset:e,position:r,linePos:i,scope:h,indent:f,group:o,mode:"",target:v,path:h.path,suggest:m,before:p,after:c}}textBefore(e){let t=this.content.slice(0,e),r=t.lastIndexOf(`
`);return t.slice(r+1)}varsAtOffset(e,t=!1){let r=this.tokenAtOffset(e),s=[],i=r.context.scope,a={};for(;i;){for(let o=0,p=I(Object.values(i.varmap)),c=p.length;o<c;o++){let l=p[o];l.globalÎ¦&&!t||a[l.name]||(!l.node||l.node.offset<e)&&(s.push(l),a[l.name]=l)}i=i.parent}return s}getOutline(e=null){var t,r,s,i;if(this.isLegacy){let y=Tr(this.content);for(let m=0,_=I(y.all),w=_.length;m<w;m++){let x=_[m];t=x.parent,delete x.parent,x.path=x.name,x.name=x.ownName,e&&e(x,y.all)}return y}this.ensureParsed();let a=Date.now(),o=[],p={children:[]},c=p,l=null,f={},u=new Set,h=null;function S(y,m){return R(y,G)&&(u.add(y),y={name:y.name,kind:y.kind}),f=y,y.token=m,y.children||(y.children=[]),y.span||(y.span=m.span),y.name||(y.name=m.value),o.push(y),c.children.push(y)}function v(y){return f.children||(f.children=[]),f.parent||(f.parent=c),c=f,c.end=y}function E(y){return c=c.parent}for(let y=0,m=I(this.tokens),_=m.length;y<_;y++){let w=m[y],x=w.symbol,k=w.scope;if(w.type=="key")S({kind:j.Key},w);else if(x){if(x.parameterÎ¦)continue;u.has(x)||S(x,w),x.body&&(h=x.body.start)}else if(k&&k.type=="do"){let b=this.textBefore(w.offset-3).replace(/^\s*(return\s*)?/,"");b+=" callback",S({kind:j.Function,name:b},w.prev),h=w}else k&&k.type=="tag"&&S({kind:j.Field,name:k.outline},w);w==h&&v(w.end),w==c.end&&E()}for(let y=0,m=I(o),_=m.length;y<_;y++){let w=m[y];if(w.span){let x=w.span.length;w.span.start=this.positionAt(w.span.offset),w.span.end=x?this.positionAt(w.span.offset+x):w.span.start}e&&e(w,o),r=w.parent,delete w.parent,s=w.end,delete w.end,i=w.token,delete w.token}return p}getContextAtOffset(e,t=!1){return this.contextAtOffset(e)}ensureParsed(){return this.parse(),this}reparse(){return this.invalidateFromLine(0),this.parse()}profileReparse(){let e=Date.now(),t=this.reparse();return console.log("took",Date.now()-e),t}tokenize(e=!1){var f;let t=this[re]||{lines:[],version:-1};if(t.version==this.version&&!e)return t;let r=this.content;this.isLegacy&&(r=r.replace(/\@\w/g,function(u){return"Â¶"+u.slice(1)}),r=r.replace(/\w\:(?=\w)/g,function(u){return u[0]+"."}),r=r.replace(/(do)(\s?)\|([^\|]*)\|/g,function(u,h,S,v){return h+"("+(S||"")+v+")"}));let s=this.lineOffsets,i=[],o=this.seed,p=Date.now(),c=this.initialState;this[re]={version:this.version,lines:[],tokens:i};let l={};this[re].cache=l;for(let u=0,h=I(t.lines),S=h.length;u<S;u++){let v=h[u];(l[f=v.text]||(l[f]=[])).push(v)}for(let u=0,h=I(s),S=h.length;u<S;u++){let v=h[u],y=s[u+1]||r.length,m=r.slice(v,y),_=c,w=l[m],x=w&&w.filter(function(z){return z.startState==_}),k=x&&(x.find(function(z){return z.offset==v})||x[0]),b=null;if(k&&(k.offset==v,b=k.clone(v)),!b){let z=ee.tokenize(m,_,v);b=new Se({offset:v,text:m,startState:_,endState:z.endState,tokens:z.tokens})}for(let z=0,O=I(b.tokens),T=O.length;z<T;z++){let C=O[z];i.push(C)}this[re].lines.push(b),c=b.endState}return this[re]}get tokens(){return this.astify(),this[re].tokens}getTokens(e=null){return this.tokens}astify(){let e=this.tokenize();if(e.root)return this;let t={"]":"[",")":"(","}":"{",">":"<"},r={"[":"]","(":")","{":"}","<":">"},s=/[\w\$\)\]\?]/,i=Date.now(),a=null,o=e.root=new te(this,this.seed,null,"root"),p=this.content,c=console.log.bind(console),l=null,f=null,u=null,h=null,S=0;for(let v=0,E=I(e.tokens),y=E.length;v<y;v++){let m=E[v],_=m.type.split("."),w=m.value,x=e.tokens[v+1],[k,b,z]=_,O=_[_.length-1],T=_[_.length-2],C=null,q=0;if(k=="ivar"&&(w=m.value="@"+w.slice(1)),h&&(h.next=m),m.prev=h,m.context=o,k=="("&&h){let P=p[m.offset-1]||"";s.test(P)&&(o=m.scope=W.args.build(this,m,o,"args",_))}if(k=="operator"&&(m.op=m.value.trim()),k=="keyword"&&(L[b]&&(S|=L[b]),(w=="let"||w=="const")&&(f=m,u=null)),k=="entity"&&(m.mods|=S,S=0),k=="push"){let P=b,U=b.lastIndexOf("_"),Ee=U>=0?B:K;U>=0?(P=P.slice(U+1),Ee=W[P]||B):W[P]&&(Ee=W[P]),o=m.scope=new Ee(this,m,o,P,_),l&&(l.body=o,o.symbol=l,l=null),o==o.scope&&(f=null,u=null)}else k=="pop"?(b=="value"&&(u=null),o=o.pop(m)):(b=="open"||r[b])&&W[k]?o=m.scope=W[k].build(this,m,o,k,_):O=="open"&&(C=W[T])?o=m.scope=C.build(this,m,o,T,_):(O=="close"&&o.type==T||b=="close"&&W[k]||t[k]&&o&&o.start.value==t[k])&&(o=o.pop(m));if(m.match(/entity\.name|decl-/)){let P=G.forToken(m,m.type,m.mods);P&&(l=m.symbol=P,m.symbol.keyword=f,o.register(m.symbol)),m.mods|=L.Declaration}if(b=="declval"&&(u=m),m.match("identifier")&&!m.symbol){let P=o.lookup(m,f);if(P&&P.scopedÎ¦&&(u&&P.keyword==f||P.addReference(m)),h&&h.op=="="&&P){let U=h.prev;U&&U.symbol==P&&(U.mods&L.Declaration?P.dereference(m):(!x||x.match("br"))&&P.dereference(U))}}h=m}return this}parse(){return this.tokens}getMatchingTokens(e){let t=this.getTokens();return t=t.slice(0).filter(function(r){return r.match(e)}),t}migrateToImba2(){let e=this.content;e=e.replace(/\bdef self\./g,"static def "),e=e.replace(/\b(var|let|const) def /g,"def "),e=e.replace(/\?\./g,".."),e=e.replace(/def ([\w\-]+)\=/g,"set $1"),e=e.replace(/do\s?\|([^\|]+)\|/g,"do($1)"),e=e.replace(/(prop) ([\w\-]+) (.+)$/gm,function(i,a,o,p){var c,l;let f={};p.split(/,\s*/).map(function(h){return h.split(/\:\s*/)}).map(function(h){return f[h[0]]=h[1]});let u=""+a+" "+o;return f.watch&&f.watch[0].match(/[\'\"\:]/)?u="@watch("+f.watch+") "+u:f.watch&&(u="@watch "+u),c=f.watch,delete f.watch,f.default&&(u=""+u+" = "+f.default,l=f.default,delete f.default),Object.keys(f).length&&console.log("more prop values",i,f),u});let r=Oe.tmp(e).getTokens(),s="";for(let i=0,a=I(r),o=a.length;i<o;i++){let p=a[i],c=r[i+1],{value:l,type:f,offset:u}=p,h=u+l.length;f=="operator.dot.legacy"&&(l=".",c&&(c.access=!0)),f=="operator.spread.legacy"&&(l="..."),f=="identifier.tagname"&&l.indexOf(":")>=0&&(l=l.replace(":","-")),f=="identifier.def.propname"&&l=="initialize"&&(l="constructor"),f=="decorator"&&!e.slice(h).match(/^\s(prop|def|get|set)/)&&(l=s+l.slice(1)),f=="property"&&(l[0]=="@"?(l=l.replace(/^\@/,s),p.access=!0):l=="len"?l="length":/^(\n|\s\:|\)|\,|\.)/.test(e.slice(h))&&!p.access&&l[0]==l[0].toLowerCase()&&(l=l+"!")),f=="identifier"&&!p.access&&l[0]==l[0].toLowerCase()&&l[0]!="_"&&!p.variable&&/^(\n|\s\:|\)|\,|\.)/.test(e.slice(h))&&l!="new"&&(l=l+"!"),p.value=l}return r.map(function(i){return i.value}).join("")}createImportEdit(e,t,r=t){e=e.replace(/\.imba$/,"");let s=this.getImportNodes().filter(function(c){return c.sourcePath==e}),i="",a=0,o=[],p={changes:o};if(this.getImportedSymbols().map(function(f){return f.importInfo}).find(function(f){return f.path==e&&f.name==r&&f.exportName==t}))return p;t!="default"&&t!="*"&&(s=s.filter(function(c){return c.specifiers||!c.ns}));for(let c=0,l=I(s),f=l.length;c<f;c++){let u=l[c],h=u.default,S=u.specifiers,v=u.namespace;if(t=="default")if(a=u.start.offset+1,h){if(h.value==r)return p;p.alias=h.value,a=0;continue}else i=r,(v||S)&&(i+=", ");else if(t=="*"){if(S)continue;h?(a=h.endOffset,i=", * as "+r):(a=u.start.offset+1,i="* as "+r+" ")}else if(v){p.alias=""+v.value+"."+t;continue}else{let E=t;r!=t&&(E+=" as "+r),S?(a=S.start.offset+1,i=" "+E+","):h?(a=h.endOffset,i=", { "+E+" }"):(i="{ "+E+" }",a=u.start.offset+1)}if(i)break}return i||(t=="default"?i="import "+r+" from '"+e+"'":t=="*"?i="import * as "+r+" from '"+e+"'":r!=t?i="import { "+t+" as "+r+" } from '"+e+"'":i="import { "+t+" } from '"+e+"'",i+=`
`),o.push({newText:i,range:this.rangeAt(a,a)}),p}},Ie=Oe;(()=>{$(Oe,is,"ImbaDocument",16)})();var os={defaultToken:"",tokenPostfix:".xml",ignoreCase:!0,qualifiedName:/(?:[\w\.\-]+:)?[\w\.\-]+/,tokenizer:{root:[[/[^<&]+/,""],{include:"@whitespace"},[/(<)(@qualifiedName)/,[{token:"delimiter"},{token:"tag",next:"@tag"}]],[/(<\/)(@qualifiedName)(\s*)(>)/,[{token:"delimiter"},{token:"tag"},"",{token:"delimiter"}]],[/(<\?)(@qualifiedName)/,[{token:"delimiter"},{token:"metatag",next:"@tag"}]],[/(<\!)(@qualifiedName)/,[{token:"delimiter"},{token:"metatag",next:"@tag"}]],[/<\!\[CDATA\[/,{token:"delimiter.cdata",next:"@cdata"}],[/&\w+;/,"string.escape"]],cdata:[[/[^\]]+/,""],[/\]\]>/,{token:"delimiter.cdata",next:"@pop"}],[/\]/,""]],tag:[[/[ \t\r\n]+/,""],[/(@qualifiedName)(\s*=\s*)("[^"]*"|'[^']*')/,["attribute.name","","attribute.value"]],[/(@qualifiedName)(\s*=\s*)("[^">?\/]*|'[^'>?\/]*)(?=[\?\/]\>)/,["attribute.name","","attribute.value"]],[/(@qualifiedName)(\s*=\s*)("[^">]*|'[^'>]*)/,["attribute.name","","attribute.value"]],[/@qualifiedName/,"attribute.name"],[/\?>/,{token:"delimiter",next:"@pop"}],[/(\/)(>)/,[{token:"tag"},{token:"delimiter",next:"@pop"}]],[/>/,{token:"delimiter",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,""],[/<!--/,{token:"comment",next:"@comment"}]],comment:[[/[^<\-]+/,"comment.content"],[/-->/,{token:"comment",next:"@pop"}],[/<!--/,"comment.content.invalid"],[/[<\-]/,"comment.content"]]}};var fr={},un=Symbol(),ur=class{static getTokenizer(e){return e=="xml"&&!fr[e]?this.createTokenizer("xml",os):fr[e]}static createTokenizer(e,t){let r=$e(e,t);return fr[e]=new le(e,r)}},Ae=ur;(()=>{$(ur,un,"Monarch",0)})();var hn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},mn={"[":"square open","]":"square close","{":"curly open","}":"curly close","(":"paren open",")":"paren close"};function as(n){return n.replace(/[\&\<\>]/g,function(e){return hn[e]})}function dn(n){return n.join(" ").replace(/[\[\]\{\}\(\)]/g,function(e){return mn[e]})}function ls(n,{verbose:e=!1}){let t=[],r=0,s=0,i=[];for(let a=0,o=I(n),p=o.length;a<p;a++){let c=o[a],l=c.value,f=c.type.split("."),[u,h]=f,S=c.mods;if(c.var){let v=i.indexOf(c.var);v==-1&&(v=i.push(c.var)-1),f.push("vref"),f.push("var"+v),f.push(c.var.type+"-ref"),S|=c.var.mods}if(S&L.Declaration&&f.push("decl"),S&L.Root&&f.push("root"),S&L.Local&&f.push("local"),c.end&&c.end.start==c&&t.push("<b>"),!((h=="start"||h=="open")&&(t.push("<b class='"+u+"'>"),!l))){if((h=="end"||h=="close")&&!l){t.push("</b>");continue}if(u=="push"){l=String(++r);let v=h.indexOf("_")>=0?"group":"scope",E=c.scope&&c.scope.end;t.push("<div class='"+v+"-"+h.split("_").pop()+" _"+h+" l"+r+" o"+c.offset+" e"+(E&&E.offset)+"'>");continue}else if(u=="pop"){l=String(--r),t.push("</div>");continue}u!="white"&&u!="line"?l="<i class='"+dn(f)+" o"+c.offset+"'>"+as(l||"")+"</i>":u=="white"&&l!=`
`&&(l="<i raw='"+JSON.stringify(l)+"'>"+as(l||"")+"</i>"),t.push(l),(h=="end"||h=="close"||c.start)&&t.push("</b>")}}return t.join("")}0&&(module.exports={CompletionTypes,Group,ImbaDocument,KeywordTypes,Keywords,M,Monarch,Node,Position,Range,Scope,SemanticTokenModifiers,SemanticTokenTypes,Sym,SymbolFlags,SymbolKind,Token,grammar,highlight,lexer});
